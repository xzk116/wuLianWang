import{d as e,aj as l,r as a,S as t,c as o,aF as r,o as s,ap as i,bl as d,g as u,f as n,C as p,m,w as c,$ as f,i as y,a0 as v,W as h,e as _,h as b,E as g,D as k,n as V,F as j,j as w,aN as U,P as x,Q as E,a$ as C,aC as N}from"./index.2pJuwT2I.js";import{v as T}from"./loading.BQ6DUTxY.js";import{E as A}from"./drawer.Bv-OqPI1.js";import"./overlay.BPxTjZGS.js";import{_ as O}from"./index.hcMAdQeb.js";import{E as M}from"./input.B2OO5Mqz.js";import{E as L}from"./input-number.DxgPYRIc.js";/* empty css                */import{E as I}from"./popper.BGBpWCzo.js";import{E as P,a as B}from"./radio-group.6pBE_0pU.js";/* empty css              *//* empty css            */import"./select.BiGfcu34.js";import"./scrollbar.Dhi4jk7C.js";import"./tree.XPAHm1Uu.js";import"./checkbox.zLZmuVb6.js";import{E as q}from"./tree-select.ycKZIFzD.js";import{E as F}from"./card.B04xyjFJ.js";import{a as G,E as S}from"./table-column.C5SY66lE.js";import{E as K,a as z}from"./form-item.CjjjooFN.js";import{E as R}from"./button.BNbP2tWD.js";import{E as X}from"./message-box.DTdoi8IV.js";import{E as D}from"./index.D2vZEoqh.js";import"./index.aA9dvPvs.js";import"./index.B10m4Dli.js";import"./vnode.BX3yTu9Q.js";import"./event.BwRzfsZt.js";import"./error.D_Dr4eZ1.js";import"./scroll.DLs6OHol.js";import"./use-form-common-props.D29gSMrk.js";import"./isUndefined.DgmxjSXK.js";import"./popover.OlUfCWeJ.js";import"./dropdown2.DZq59H1D.js";import"./tab-pane.HcOeyw39.js";import"./strings.QOiT_3Y0.js";import"./index.C7_u6wBt.js";import"./_plugin-vue_export-helper.BCo6x5W8.js";import"./index.DhsF0caO.js";import"./_arrayPush.B3SSnwHj.js";import"./index.mU3M88aD.js";import"./index.Bqp7DTQo.js";import"./index.DoeIG70-.js";import"./token.DWNpOE8r.js";import"./castArray.C93Im9Sd.js";import"./isEqual.BpLWMaHT.js";import"./_Uint8Array.BAz41YYn.js";import"./debounce.BJMtmguk.js";import"./_baseIteratee.CLEVGq9d.js";import"./index.DwFzoLCE.js";import"./index.Cp2l8fok.js";import"./_initCloneObject.AdcQFJme.js";import"./index.BTKOuuO-.js";var $=(e=>(e[e.CATALOG=2]="CATALOG",e[e.MENU=1]="MENU",e[e.BUTTON=4]="BUTTON",e[e.EXTLINK=3]="EXTLINK",e))($||{});const Q={class:"app-container"},W={class:"search-bar"},Y={class:"mb-10px"},Z={class:"flex-y-center"},H={class:"flex-y-center"},J={class:"flex-y-center"},ee={class:"flex-y-center"},le={key:0},ae={key:1},te={class:"flex-y-center"},oe={class:"dialog-footer"},re=e({name:"SysMenu",inheritAttrs:!1,__name:"index",setup(e){const re=l(),se=a(),ie=a(),de=a(!1),ue=t({title:"新增菜单",visible:!1}),ne=o((()=>re.device===r.DESKTOP?"600px":"90%")),pe=t({}),me=a([]),ce=a([]),fe=a({id:void 0,parentId:"0",visible:1,sort:1,type:$.MENU,alwaysShow:0,keepAlive:1,params:[]}),ye=a({...fe.value}),ve=t({parentId:[{required:!0,message:"请选择父级菜单",trigger:"blur"}],name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],type:[{required:!0,message:"请选择菜单类型",trigger:"blur"}],routeName:[{required:!0,message:"请输入路由名称",trigger:"blur"}],routePath:[{required:!0,message:"请输入路由路径",trigger:"blur"}],component:[{required:!0,message:"请输入组件路径",trigger:"blur"}],visible:[{required:!0,message:"请选择显示状态",trigger:"change"}]}),he=a();function _e(){de.value=!0,C.getList(pe).then((e=>{me.value=e})).finally((()=>{de.value=!1}))}function be(){se.value.resetFields(),_e()}function ge(e){he.value=e.id}function ke(e,l){C.getOptions(!0).then((e=>{ce.value=[{value:"0",label:"顶级菜单",children:e}]})).then((()=>{ue.visible=!0,l?(ue.title="编辑菜单",C.getFormData(l).then((e=>{fe.value={...e},ye.value=e}))):(ue.title="新增菜单",ye.value.parentId=null==e?void 0:e.toString())}))}function Ve(){ye.value.type!==fe.value.type&&ye.value.type===$.MENU&&(fe.value.type===$.CATALOG?ye.value.component="":(ye.value.routePath=fe.value.routePath,ye.value.component=fe.value.component))}function je(){ie.value.validate((e=>{if(e){const e=ye.value.id;if(e){if(ye.value.parentId==e)return void N.error("父级菜单不能为当前菜单");C.update(e,ye.value).then((()=>{N.success("修改成功"),we(),_e()}))}else C.create(ye.value).then((()=>{N.success("新增成功"),we(),_e()}))}}))}function we(){ue.visible=!1,ie.value.resetFields(),ie.value.clearValidate(),ye.value={id:void 0,parentId:"0",visible:1,sort:1,type:$.MENU,alwaysShow:0,keepAlive:1,params:[]}}return s((()=>{_e()})),(e,l)=>{const a=M,t=K,o=R,r=z,s=g,re=S,fe=D,he=G,Ue=F,xe=q,Ee=B,Ce=P,Ne=i("QuestionFilled"),Te=I,Ae=i("CirclePlusFilled"),Oe=i("DeleteFilled"),Me=L,Le=O,Ie=A,Pe=d("hasPerm"),Be=T;return n(),u("div",Q,[p("div",W,[m(r,{ref_key:"queryFormRef",ref:se,model:y(pe),inline:!0},{default:c((()=>[m(t,{label:"关键字",prop:"keywords"},{default:c((()=>[m(a,{modelValue:y(pe).keywords,"onUpdate:modelValue":l[0]||(l[0]=e=>y(pe).keywords=e),placeholder:"菜单名称",clearable:"",onKeyup:f(_e,["enter"])},null,8,["modelValue"])])),_:1}),m(t,null,{default:c((()=>[m(o,{type:"primary",icon:"search",onClick:_e},{default:c((()=>l[20]||(l[20]=[v("搜索")]))),_:1}),m(o,{icon:"refresh",onClick:be},{default:c((()=>l[21]||(l[21]=[v("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),m(Ue,{shadow:"never"},{default:c((()=>[p("div",Y,[h((n(),_(o,{type:"success",icon:"plus",onClick:l[1]||(l[1]=e=>ke("0"))},{default:c((()=>l[22]||(l[22]=[v(" 新增 ")]))),_:1})),[[Pe,["sys:menu:add"]]])]),h((n(),_(he,{data:y(me),"highlight-current-row":"","row-key":"id","tree-props":{children:"children",hasChildren:"hasChildren"},onRowClick:ge},{default:c((()=>[m(re,{label:"菜单名称","min-width":"200"},{default:c((e=>[e.row.icon&&e.row.icon.startsWith("el-icon")?(n(),_(s,{key:0,style:{"vertical-align":"-0.15em"}},{default:c((()=>[(n(),_(k(e.row.icon.replace("el-icon-",""))))])),_:2},1024)):e.row.icon?(n(),u("div",{key:1,class:V(`i-svg:${e.row.icon}`)},null,2)):b("",!0),v(" "+j(e.row.name),1)])),_:1}),m(re,{label:"类型",align:"center",width:"80"},{default:c((e=>[e.row.type===y($).CATALOG?(n(),_(fe,{key:0,type:"warning"},{default:c((()=>l[23]||(l[23]=[v("目录")]))),_:1})):b("",!0),e.row.type===y($).MENU?(n(),_(fe,{key:1,type:"success"},{default:c((()=>l[24]||(l[24]=[v("菜单")]))),_:1})):b("",!0),e.row.type===y($).BUTTON?(n(),_(fe,{key:2,type:"danger"},{default:c((()=>l[25]||(l[25]=[v("按钮")]))),_:1})):b("",!0),e.row.type===y($).EXTLINK?(n(),_(fe,{key:3,type:"info"},{default:c((()=>l[26]||(l[26]=[v("外链")]))),_:1})):b("",!0)])),_:1}),m(re,{label:"路由名称",align:"left",width:"150",prop:"routeName"}),m(re,{label:"路由路径",align:"left",width:"150",prop:"routePath"}),m(re,{label:"组件路径",align:"left",width:"250",prop:"component"}),m(re,{label:"权限标识",align:"center",width:"200",prop:"perm"}),m(re,{label:"状态",align:"center",width:"80"},{default:c((e=>[1===e.row.visible?(n(),_(fe,{key:0,type:"success"},{default:c((()=>l[27]||(l[27]=[v("显示")]))),_:1})):(n(),_(fe,{key:1,type:"info"},{default:c((()=>l[28]||(l[28]=[v("隐藏")]))),_:1}))])),_:1}),m(re,{label:"排序",align:"center",width:"80",prop:"sort"}),m(re,{fixed:"right",align:"center",label:"操作",width:"220"},{default:c((e=>[e.row.type==y($).CATALOG||e.row.type==y($).MENU?h((n(),_(o,{key:0,type:"primary",link:"",size:"small",icon:"plus",onClick:w((l=>ke(e.row.id)),["stop"])},{default:c((()=>l[29]||(l[29]=[v(" 新增 ")]))),_:2},1032,["onClick"])),[[Pe,["sys:menu:add"]]]):b("",!0),h((n(),_(o,{type:"primary",link:"",size:"small",icon:"edit",onClick:w((l=>ke(void 0,e.row.id)),["stop"])},{default:c((()=>l[30]||(l[30]=[v(" 编辑 ")]))),_:2},1032,["onClick"])),[[Pe,["sys:menu:edit"]]]),h((n(),_(o,{type:"danger",link:"",size:"small",icon:"delete",onClick:w((l=>function(e){if(!e)return N.warning("请勾选删除项"),!1;X.confirm("确认删除已选中的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{de.value=!0,C.deleteById(e).then((()=>{N.success("删除成功"),_e()})).finally((()=>{de.value=!1}))}),(()=>{N.info("已取消删除")}))}(e.row.id)),["stop"])},{default:c((()=>l[31]||(l[31]=[v(" 删除 ")]))),_:2},1032,["onClick"])),[[Pe,["sys:menu:delete"]]])])),_:1})])),_:1},8,["data"])),[[Be,y(de)]])])),_:1}),m(Ie,{modelValue:y(ue).visible,"onUpdate:modelValue":l[19]||(l[19]=e=>y(ue).visible=e),title:y(ue).title,size:y(ne),onClose:we},{footer:c((()=>[p("div",oe,[m(o,{type:"primary",onClick:je},{default:c((()=>l[56]||(l[56]=[v("确 定")]))),_:1}),m(o,{onClick:we},{default:c((()=>l[57]||(l[57]=[v("取 消")]))),_:1})])])),default:c((()=>[m(r,{ref_key:"menuFormRef",ref:ie,model:y(ye),rules:y(ve),"label-width":"100px"},{default:c((()=>[m(t,{label:"父级菜单",prop:"parentId"},{default:c((()=>[m(xe,{modelValue:y(ye).parentId,"onUpdate:modelValue":l[2]||(l[2]=e=>y(ye).parentId=e),placeholder:"选择上级菜单",data:y(ce),filterable:"","check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])])),_:1}),m(t,{label:"菜单名称",prop:"name"},{default:c((()=>[m(a,{modelValue:y(ye).name,"onUpdate:modelValue":l[3]||(l[3]=e=>y(ye).name=e),placeholder:"请输入菜单名称"},null,8,["modelValue"])])),_:1}),m(t,{label:"菜单类型",prop:"type"},{default:c((()=>[m(Ce,{modelValue:y(ye).type,"onUpdate:modelValue":l[4]||(l[4]=e=>y(ye).type=e),onChange:Ve},{default:c((()=>[m(Ee,{value:y($).CATALOG},{default:c((()=>l[32]||(l[32]=[v("目录")]))),_:1},8,["value"]),m(Ee,{value:y($).MENU},{default:c((()=>l[33]||(l[33]=[v("菜单")]))),_:1},8,["value"]),m(Ee,{value:y($).BUTTON},{default:c((()=>l[34]||(l[34]=[v("按钮")]))),_:1},8,["value"]),m(Ee,{value:y($).EXTLINK},{default:c((()=>l[35]||(l[35]=[v("外链")]))),_:1},8,["value"])])),_:1},8,["modelValue"])])),_:1}),y(ye).type==y($).EXTLINK?(n(),_(t,{key:0,label:"外链地址",prop:"path"},{default:c((()=>[m(a,{modelValue:y(ye).routePath,"onUpdate:modelValue":l[5]||(l[5]=e=>y(ye).routePath=e),placeholder:"请输入外链完整路径"},null,8,["modelValue"])])),_:1})):b("",!0),y(ye).type==y($).MENU?(n(),_(t,{key:1,prop:"routeName"},{label:c((()=>[p("div",Z,[l[37]||(l[37]=v(" 路由名称 ")),m(Te,{placement:"bottom",effect:"light"},{content:c((()=>l[36]||(l[36]=[v(" 如果需要开启缓存，需保证页面 defineOptions 中的 name 与此处一致，建议使用驼峰。 ")]))),default:c((()=>[m(s,{class:"ml-1 cursor-pointer"},{default:c((()=>[m(Ne)])),_:1})])),_:1})])])),default:c((()=>[m(a,{modelValue:y(ye).routeName,"onUpdate:modelValue":l[6]||(l[6]=e=>y(ye).routeName=e),placeholder:"User"},null,8,["modelValue"])])),_:1})):b("",!0),y(ye).type==y($).CATALOG||y(ye).type==y($).MENU?(n(),_(t,{key:2,prop:"routePath"},{label:c((()=>[p("div",H,[l[39]||(l[39]=v(" 路由路径 ")),m(Te,{placement:"bottom",effect:"light"},{content:c((()=>l[38]||(l[38]=[v(" 定义应用中不同页面对应的 URL 路径，目录需以 / 开头，菜单项不用。例如：系统管理目录 /system，系统管理下的用户管理菜单 user。 ")]))),default:c((()=>[m(s,{class:"ml-1 cursor-pointer"},{default:c((()=>[m(Ne)])),_:1})])),_:1})])])),default:c((()=>[y(ye).type==y($).CATALOG?(n(),_(a,{key:0,modelValue:y(ye).routePath,"onUpdate:modelValue":l[7]||(l[7]=e=>y(ye).routePath=e),placeholder:"system"},null,8,["modelValue"])):(n(),_(a,{key:1,modelValue:y(ye).routePath,"onUpdate:modelValue":l[8]||(l[8]=e=>y(ye).routePath=e),placeholder:"user"},null,8,["modelValue"]))])),_:1})):b("",!0),y(ye).type==y($).MENU?(n(),_(t,{key:3,prop:"component"},{label:c((()=>[p("div",J,[l[41]||(l[41]=v(" 组件路径 ")),m(Te,{placement:"bottom",effect:"light"},{content:c((()=>l[40]||(l[40]=[v(" 组件页面完整路径，相对于 src/views/，如 system/user/index，缺省后缀 .vue ")]))),default:c((()=>[m(s,{class:"ml-1 cursor-pointer"},{default:c((()=>[m(Ne)])),_:1})])),_:1})])])),default:c((()=>[m(a,{modelValue:y(ye).component,"onUpdate:modelValue":l[9]||(l[9]=e=>y(ye).component=e),placeholder:"system/user/index",style:{width:"95%"}},U({_:2},[y(ye).type==y($).MENU?{name:"prepend",fn:c((()=>[l[42]||(l[42]=v("src/views/"))])),key:"0"}:void 0,y(ye).type==y($).MENU?{name:"append",fn:c((()=>[l[43]||(l[43]=v(".vue"))])),key:"1"}:void 0]),1032,["modelValue"])])),_:1})):b("",!0),y(ye).type==y($).MENU?(n(),_(t,{key:4},{label:c((()=>[p("div",ee,[l[45]||(l[45]=v(" 路由参数 ")),m(Te,{placement:"bottom",effect:"light"},{content:c((()=>l[44]||(l[44]=[v(" 组件页面使用 `useRoute().query.参数名` 获取路由参数值。 ")]))),default:c((()=>[m(s,{class:"ml-1 cursor-pointer"},{default:c((()=>[m(Ne)])),_:1})])),_:1})])])),default:c((()=>[y(ye).params&&0!==y(ye).params.length?(n(),u("div",ae,[(n(!0),u(x,null,E(y(ye).params,((e,t)=>(n(),u("div",{key:t},[m(a,{modelValue:e.key,"onUpdate:modelValue":l=>e.key=l,placeholder:"参数名",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"]),l[47]||(l[47]=p("span",{class:"mx-1"},"=",-1)),m(a,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,placeholder:"参数值",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"]),y(ye).params.indexOf(e)===y(ye).params.length-1?(n(),_(s,{key:0,class:"ml-2 cursor-pointer color-[var(--el-color-success)]",style:{"vertical-align":"-0.15em"},onClick:l[11]||(l[11]=e=>y(ye).params.push({key:"",value:""}))},{default:c((()=>[m(Ae)])),_:1})):b("",!0),m(s,{class:"ml-2 cursor-pointer color-[var(--el-color-danger)]",style:{"vertical-align":"-0.15em"},onClick:l=>y(ye).params.splice(y(ye).params.indexOf(e),1)},{default:c((()=>[m(Oe)])),_:2},1032,["onClick"])])))),128))])):(n(),u("div",le,[m(o,{type:"success",plain:"",onClick:l[10]||(l[10]=e=>y(ye).params=[{key:"",value:""}])},{default:c((()=>l[46]||(l[46]=[v(" 添加路由参数 ")]))),_:1})]))])),_:1})):b("",!0),y(ye).type!==y($).BUTTON?(n(),_(t,{key:5,prop:"visible",label:"显示状态"},{default:c((()=>[m(Ce,{modelValue:y(ye).visible,"onUpdate:modelValue":l[12]||(l[12]=e=>y(ye).visible=e)},{default:c((()=>[m(Ee,{value:1},{default:c((()=>l[48]||(l[48]=[v("显示")]))),_:1}),m(Ee,{value:0},{default:c((()=>l[49]||(l[49]=[v("隐藏")]))),_:1})])),_:1},8,["modelValue"])])),_:1})):b("",!0),y(ye).type===y($).CATALOG||y(ye).type===y($).MENU?(n(),_(t,{key:6},{label:c((()=>[p("div",te,[l[51]||(l[51]=v(" 始终显示 ")),m(Te,{placement:"bottom",effect:"light"},{content:c((()=>l[50]||(l[50]=[v(" 选择“是”，即使目录或菜单下只有一个子节点，也会显示父节点。 "),p("br",null,null,-1),v(" 选择“否”，如果目录或菜单下只有一个子节点，则只显示该子节点，隐藏父节点。 "),p("br",null,null,-1),v(" 如果是叶子节点，请选择“否”。 ")]))),default:c((()=>[m(s,{class:"ml-1 cursor-pointer"},{default:c((()=>[m(Ne)])),_:1})])),_:1})])])),default:c((()=>[m(Ce,{modelValue:y(ye).alwaysShow,"onUpdate:modelValue":l[13]||(l[13]=e=>y(ye).alwaysShow=e)},{default:c((()=>[m(Ee,{value:1},{default:c((()=>l[52]||(l[52]=[v("是")]))),_:1}),m(Ee,{value:0},{default:c((()=>l[53]||(l[53]=[v("否")]))),_:1})])),_:1},8,["modelValue"])])),_:1})):b("",!0),y(ye).type===y($).MENU?(n(),_(t,{key:7,label:"缓存页面"},{default:c((()=>[m(Ce,{modelValue:y(ye).keepAlive,"onUpdate:modelValue":l[14]||(l[14]=e=>y(ye).keepAlive=e)},{default:c((()=>[m(Ee,{value:1},{default:c((()=>l[54]||(l[54]=[v("开启")]))),_:1}),m(Ee,{value:0},{default:c((()=>l[55]||(l[55]=[v("关闭")]))),_:1})])),_:1},8,["modelValue"])])),_:1})):b("",!0),m(t,{label:"排序",prop:"sort"},{default:c((()=>[m(Me,{modelValue:y(ye).sort,"onUpdate:modelValue":l[15]||(l[15]=e=>y(ye).sort=e),style:{width:"100px"},"controls-position":"right",min:0},null,8,["modelValue"])])),_:1}),y(ye).type==y($).BUTTON?(n(),_(t,{key:8,label:"权限标识",prop:"perm"},{default:c((()=>[m(a,{modelValue:y(ye).perm,"onUpdate:modelValue":l[16]||(l[16]=e=>y(ye).perm=e),placeholder:"sys:user:add"},null,8,["modelValue"])])),_:1})):b("",!0),y(ye).type!==y($).BUTTON?(n(),_(t,{key:9,label:"图标",prop:"icon"},{default:c((()=>[m(Le,{modelValue:y(ye).icon,"onUpdate:modelValue":l[17]||(l[17]=e=>y(ye).icon=e)},null,8,["modelValue"])])),_:1})):b("",!0),y(ye).type==y($).CATALOG?(n(),_(t,{key:10,label:"跳转路由"},{default:c((()=>[m(a,{modelValue:y(ye).redirect,"onUpdate:modelValue":l[18]||(l[18]=e=>y(ye).redirect=e),placeholder:"跳转路由"},null,8,["modelValue"])])),_:1})):b("",!0)])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title","size"])])}}});export{re as default};
