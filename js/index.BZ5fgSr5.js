import{d as e,r as t,S as a,o as l,bl as o,g as s,f as r,C as i,m as d,w as n,$ as p,i as u,a0 as m,W as c,e as f,j,aC as b}from"./index.C4XHQ947.js";import{v as h}from"./loading.BmtaAxB7.js";import{E as y}from"./dialog.CtZ3QWD-.js";import"./overlay.BSrIvsx2.js";import{E as _,a as v}from"./radio-group.D-1lM7a4.js";/* empty css              */import{E as g}from"./input.acwFxw-O.js";import{E as k}from"./input-number.DE2d5zNI.js";/* empty css            */import{E as V,a as x}from"./select.BjtaYayC.js";import"./scrollbar.BohePXPP.js";import"./popper.DyOsyU0d.js";import"./tree.Ck8ykSKU.js";import"./checkbox.CmADlFKQ.js";import{E as w}from"./tree-select.xP3lKzbL.js";import{E as C}from"./card.BiRPT1LQ.js";import{a as E,E as I}from"./table-column.diEZPI-c.js";/* empty css                */import{E as U,a as q}from"./form-item.ClXYt8Tp.js";import{E as F}from"./button.D2DEk6fY.js";import{D as B}from"./dept.api.FpFnROI-.js";import{E as R}from"./message-box.daPbjmmn.js";import{E as S}from"./index.Dws5OK1z.js";import"./index.BZB15hwD.js";import"./refs.B6GNUP0k.js";import"./index.DLtoAZtP.js";import"./vnode.DMlOg4yB.js";import"./event.BwRzfsZt.js";import"./error.D_Dr4eZ1.js";import"./scroll.Tblv70v8.js";import"./use-form-common-props.g5CCADeT.js";import"./isUndefined.DgmxjSXK.js";import"./index.LcwZUvgm.js";import"./_arrayPush.81Ix0M9y.js";import"./index.BbvO-npD.js";import"./index.BtA1p4fI.js";import"./index.CPgzIetu.js";import"./token.DWNpOE8r.js";import"./strings.DfZTWvp0.js";import"./castArray.BlrEgLSE.js";import"./isEqual.DRNAkb0Y.js";import"./_Uint8Array.DWUdcecF.js";import"./debounce.B-wgC4Nx.js";import"./_baseIteratee.DBVoi9B7.js";import"./index.CpXLvEZo.js";import"./index.CRcPiJM1.js";import"./_initCloneObject.DCnv6bQV.js";const z={class:"app-container"},A={class:"search-bar"},D={class:"mb-10px"},O={class:"dialog-footer"},P=e({name:"Dept",inheritAttrs:!1,__name:"index",setup(e){const P=t(),T=t(),K=t(!1),L=t([]),W=a({}),$=a({title:"",visible:!1}),G=t(),H=t(),J=a({status:1,parentId:"0",sort:1}),M=a({parentId:[{required:!0,message:"上级部门不能为空",trigger:"change"}],name:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],code:[{required:!0,message:"部门编号不能为空",trigger:"blur"}],sort:[{required:!0,message:"显示排序不能为空",trigger:"blur"}]});function N(){K.value=!0,B.getList(W).then((e=>{G.value=e,K.value=!1}))}function X(){P.value.resetFields(),N()}function Y(e){L.value=e.map((e=>e.id))}async function Z(e,t){const a=await B.getOptions();H.value=[{value:"0",label:"顶级部门",children:a}],$.visible=!0,t?($.title="修改部门",B.getFormData(t).then((e=>{Object.assign(J,e)}))):($.title="新增部门",J.parentId=e||"0")}function Q(){T.value.validate((e=>{if(e){K.value=!0;const e=J.id;e?B.update(e,J).then((()=>{b.success("修改成功"),te(),N()})).finally((()=>K.value=!1)):B.create(J).then((()=>{b.success("新增成功"),te(),N()})).finally((()=>K.value=!1))}}))}function ee(e){const t=[e||L.value].join(",");t?R.confirm("确认删除已选中的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{K.value=!0,B.deleteByIds(t).then((()=>{b.success("删除成功"),X()})).finally((()=>K.value=!1))}),(()=>{b.info("已取消删除")})):b.warning("请勾选删除项")}function te(){$.visible=!1,T.value.resetFields(),T.value.clearValidate(),J.id=void 0,J.parentId="0",J.status=1,J.sort=1}return l((()=>{N()})),(e,t)=>{const a=g,l=U,b=x,B=V,R=F,ae=q,le=I,oe=S,se=E,re=C,ie=w,de=k,ne=v,pe=_,ue=y,me=o("hasPerm"),ce=h;return r(),s("div",z,[i("div",A,[d(ae,{ref_key:"queryFormRef",ref:P,model:u(W),inline:!0},{default:n((()=>[d(l,{label:"关键字",prop:"keywords"},{default:n((()=>[d(a,{modelValue:u(W).keywords,"onUpdate:modelValue":t[0]||(t[0]=e=>u(W).keywords=e),placeholder:"部门名称",onKeyup:p(N,["enter"])},null,8,["modelValue"])])),_:1}),d(l,{label:"部门状态",prop:"status"},{default:n((()=>[d(B,{modelValue:u(W).status,"onUpdate:modelValue":t[1]||(t[1]=e=>u(W).status=e),placeholder:"全部",clearable:"",class:"!w-[100px]"},{default:n((()=>[d(b,{value:1,label:"正常"}),d(b,{value:0,label:"禁用"})])),_:1},8,["modelValue"])])),_:1}),d(l,null,{default:n((()=>[d(R,{class:"filter-item",type:"primary",icon:"search",onClick:N},{default:n((()=>t[10]||(t[10]=[m(" 搜索 ")]))),_:1}),d(R,{icon:"refresh",onClick:X},{default:n((()=>t[11]||(t[11]=[m("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),d(re,{shadow:"never"},{default:n((()=>[i("div",D,[c((r(),f(R,{type:"success",icon:"plus",onClick:t[2]||(t[2]=e=>Z())},{default:n((()=>t[12]||(t[12]=[m(" 新增 ")]))),_:1})),[[me,["sys:dept:add"]]]),c((r(),f(R,{type:"danger",disabled:0===u(L).length,icon:"delete",onClick:t[3]||(t[3]=e=>ee())},{default:n((()=>t[13]||(t[13]=[m(" 删除 ")]))),_:1},8,["disabled"])),[[me,["sys:dept:delete"]]])]),c((r(),f(se,{data:u(G),"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},onSelectionChange:Y},{default:n((()=>[d(le,{type:"selection",width:"55",align:"center"}),d(le,{prop:"name",label:"部门名称","min-width":"200"}),d(le,{prop:"code",label:"部门编号",width:"200"}),d(le,{prop:"status",label:"状态",width:"100"},{default:n((e=>[1==e.row.status?(r(),f(oe,{key:0,type:"success"},{default:n((()=>t[14]||(t[14]=[m("正常")]))),_:1})):(r(),f(oe,{key:1,type:"info"},{default:n((()=>t[15]||(t[15]=[m("禁用")]))),_:1}))])),_:1}),d(le,{prop:"sort",label:"排序",width:"100"}),d(le,{label:"操作",fixed:"right",align:"left",width:"200"},{default:n((e=>[c((r(),f(R,{type:"primary",link:"",size:"small",icon:"plus",onClick:j((t=>Z(e.row.id,void 0)),["stop"])},{default:n((()=>t[16]||(t[16]=[m(" 新增 ")]))),_:2},1032,["onClick"])),[[me,["sys:dept:add"]]]),c((r(),f(R,{type:"primary",link:"",size:"small",icon:"edit",onClick:j((t=>Z(e.row.parentId,e.row.id)),["stop"])},{default:n((()=>t[17]||(t[17]=[m(" 编辑 ")]))),_:2},1032,["onClick"])),[[me,["sys:dept:edit"]]]),c((r(),f(R,{type:"danger",link:"",size:"small",icon:"delete",onClick:j((t=>ee(e.row.id)),["stop"])},{default:n((()=>t[18]||(t[18]=[m(" 删除 ")]))),_:2},1032,["onClick"])),[[me,["sys:dept:delete"]]])])),_:1})])),_:1},8,["data"])),[[ce,u(K)]])])),_:1}),d(ue,{modelValue:u($).visible,"onUpdate:modelValue":t[9]||(t[9]=e=>u($).visible=e),title:u($).title,width:"600px",onClosed:te},{footer:n((()=>[i("div",O,[d(R,{type:"primary",onClick:Q},{default:n((()=>t[21]||(t[21]=[m("确 定")]))),_:1}),d(R,{onClick:te},{default:n((()=>t[22]||(t[22]=[m("取 消")]))),_:1})])])),default:n((()=>[d(ae,{ref_key:"deptFormRef",ref:T,model:u(J),rules:u(M),"label-width":"80px"},{default:n((()=>[d(l,{label:"上级部门",prop:"parentId"},{default:n((()=>[d(ie,{modelValue:u(J).parentId,"onUpdate:modelValue":t[4]||(t[4]=e=>u(J).parentId=e),placeholder:"选择上级部门",data:u(H),filterable:"","check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])])),_:1}),d(l,{label:"部门名称",prop:"name"},{default:n((()=>[d(a,{modelValue:u(J).name,"onUpdate:modelValue":t[5]||(t[5]=e=>u(J).name=e),placeholder:"请输入部门名称"},null,8,["modelValue"])])),_:1}),d(l,{label:"部门编号",prop:"code"},{default:n((()=>[d(a,{modelValue:u(J).code,"onUpdate:modelValue":t[6]||(t[6]=e=>u(J).code=e),placeholder:"请输入部门编号"},null,8,["modelValue"])])),_:1}),d(l,{label:"显示排序",prop:"sort"},{default:n((()=>[d(de,{modelValue:u(J).sort,"onUpdate:modelValue":t[7]||(t[7]=e=>u(J).sort=e),"controls-position":"right",style:{width:"100px"},min:0},null,8,["modelValue"])])),_:1}),d(l,{label:"部门状态"},{default:n((()=>[d(pe,{modelValue:u(J).status,"onUpdate:modelValue":t[8]||(t[8]=e=>u(J).status=e)},{default:n((()=>[d(ne,{value:1},{default:n((()=>t[19]||(t[19]=[m("正常")]))),_:1}),d(ne,{value:0},{default:n((()=>t[20]||(t[20]=[m("禁用")]))),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}});export{P as default};
