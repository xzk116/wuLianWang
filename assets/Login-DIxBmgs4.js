import{d as e,ak as a,aI as r,ah as l,o,r as t,c as s,bU as i,ar as n,g as d,f as u,C as p,m,F as c,i as f,w as g,E as v,$ as x,e as h,a0 as _,aA as y}from"./index-7csCyfhe.js";import{E as j}from"./divider-BXKqHAo2.js";import{E as w}from"./text-D7VKa7SP.js";import{E as b,a as C}from"./form-item-c_dGGftV.js";import{E as V}from"./button-CHGwtw2-.js";import{E as k}from"./link-wob_tTx5.js";import{E as q}from"./checkbox-fdsK1aFR.js";/* empty css                */import{E}from"./popper-CLitXFbi.js";import{E as M}from"./input-DsfvDsUe.js";import{C as U}from"./index-CxBzyMhp.js";import"./use-form-common-props--xs_plq7.js";import"./castArray-DQKN13g8.js";import"./error-D213Yp32.js";import"./_Uint8Array-Bb2Vd-u-.js";import"./_initCloneObject-rkkgR2S4.js";import"./index-BeBPSnPV.js";import"./index-u8nA5kYO.js";import"./event-BwRzfsZt.js";import"./isEqual-CxWr6Nld.js";import"./index-C_qgbi3r.js";import"./index-BFZw3KWt.js";import"./index-CFy7uQxK.js";import"./plugin-vueexport-helper-BCo6x5W8.js";const K={"text-center":"","m-0":"","mb-20px":""},L={flex:""},A=["src"],z={class:"flex-x-between w-full"},P={"flex-center":"","gap-10px":""},F={class:"flex-center gap-x-5 w-full text-[var(--el-text-color-secondary)]"},I=e({__name:"Login",emits:["update:modelValue"],setup(e,{emit:I}){const{t:S}=a(),B=r(),O=l();o((()=>G()));const Q=t(),R=t(!1),X=t(!1),Y=t(),Z=t({username:"admin",password:"123456",captchaKey:"",captchaCode:"",rememberMe:!1}),$=s((()=>({username:[{required:!0,trigger:"blur",message:S("login.message.username.required")}],password:[{required:!0,trigger:"blur",message:S("login.message.password.required")},{min:6,message:S("login.message.password.min"),trigger:"blur"}],captchaCode:[{required:!0,trigger:"blur",message:S("login.message.captchaCode.required")}]}))),D=t(!1);function G(){D.value=!0,i.getCaptcha().then((e=>{Z.value.captchaKey=e.captchaKey,Y.value=e.captchaBase64})).finally((()=>D.value=!1))}async function H(){var e;try{if(!(await(null==(e=Q.value)?void 0:e.validate())))return;R.value=!0,await B.login(Z.value),await B.getUserInfo();const a=function(e){const a="/",r=e.redirect||a;try{const e=y.resolve(r);return{path:e.path,query:e.query}}catch{return{path:a}}}(O.query);await y.push(a)}catch(a){G()}finally{R.value=!1}}function J(e){e instanceof KeyboardEvent&&(X.value=e.getModifierState("CapsLock"))}const N=I;function T(e){N("update:modelValue",e)}return(e,a)=>{const r=n("User"),l=v,o=M,t=b,s=n("Lock"),i=E,y=n("Loading"),I=q,B=k,O=V,N=C,W=w,ee=j;return u(),d("div",null,[p("h3",K,c(f(S)("login.login")),1),m(N,{ref_key:"loginFormRef",ref:Q,model:f(Z),rules:f($),size:"large"},{default:g((()=>[m(t,{prop:"username"},{default:g((()=>[m(o,{modelValue:f(Z).username,"onUpdate:modelValue":a[0]||(a[0]=e=>f(Z).username=e),modelModifiers:{trim:!0},placeholder:f(S)("login.username")},{prefix:g((()=>[m(l,null,{default:g((()=>[m(r)])),_:1})])),_:1},8,["modelValue","placeholder"])])),_:1}),m(i,{visible:f(X),content:f(S)("login.capsLock"),placement:"right"},{default:g((()=>[m(t,{prop:"password"},{default:g((()=>[m(o,{modelValue:f(Z).password,"onUpdate:modelValue":a[1]||(a[1]=e=>f(Z).password=e),modelModifiers:{trim:!0},placeholder:f(S)("login.password"),type:"password","show-password":"",onKeyup:[J,x(H,["enter"])]},{prefix:g((()=>[m(l,null,{default:g((()=>[m(s)])),_:1})])),_:1},8,["modelValue","placeholder"])])),_:1})])),_:1},8,["visible","content"]),m(t,{prop:"captchaCode"},{default:g((()=>[p("div",L,[m(o,{modelValue:f(Z).captchaCode,"onUpdate:modelValue":a[2]||(a[2]=e=>f(Z).captchaCode=e),modelModifiers:{trim:!0},placeholder:f(S)("login.captchaCode"),onKeyup:x(H,["enter"])},{prefix:g((()=>a[6]||(a[6]=[p("div",{class:"i-svg:captcha"},null,-1)]))),_:1},8,["modelValue","placeholder"]),p("div",{"cursor-pointer":"",h:"[40px]",w:"[120px]","flex-center":"","ml-10px":"",onClick:G},[f(D)?(u(),h(l,{key:0,class:"is-loading"},{default:g((()=>[m(y)])),_:1})):(u(),d("img",{key:1,"object-cover":"","border-rd-4px":"","p-1px":"",shadow:"[0_0_0_1px_var(--el-border-color)_inset]",src:f(Y),alt:"code"},null,8,A))])])])),_:1}),p("div",z,[m(I,{modelValue:f(Z).rememberMe,"onUpdate:modelValue":a[3]||(a[3]=e=>f(Z).rememberMe=e)},{default:g((()=>[_(c(f(S)("login.rememberMe")),1)])),_:1},8,["modelValue"]),m(B,{type:"primary",underline:"never",onClick:a[4]||(a[4]=e=>T("resetPwd"))},{default:g((()=>[_(c(f(S)("login.forgetPassword")),1)])),_:1})]),m(t,null,{default:g((()=>[m(O,{loading:f(R),type:"primary",class:"w-full",onClick:H},{default:g((()=>[_(c(f(S)("login.login")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["model","rules"]),p("div",P,[m(W,{size:"default"},{default:g((()=>[_(c(f(S)("login.noAccount")),1)])),_:1}),m(B,{type:"primary",underline:"never",onClick:a[5]||(a[5]=e=>T("register"))},{default:g((()=>[_(c(f(S)("login.reg")),1)])),_:1})]),m(ee,null,{default:g((()=>[m(W,{size:"small"},{default:g((()=>[_(c(f(S)("login.otherLoginMethods")),1)])),_:1})])),_:1}),p("div",F,[m(U,null,{default:g((()=>a[7]||(a[7]=[p("div",{"text-20px":"",class:"i-svg:wechat"},null,-1)]))),_:1}),m(U,null,{default:g((()=>a[8]||(a[8]=[p("div",{"text-20px":"","cursor-pointer":"",class:"i-svg:qq"},null,-1)]))),_:1}),m(U,null,{default:g((()=>a[9]||(a[9]=[p("div",{"text-20px":"","cursor-pointer":"",class:"i-svg:github"},null,-1)]))),_:1}),m(U,null,{default:g((()=>a[10]||(a[10]=[p("div",{"text-20px":"","cursor-pointer":"",class:"i-svg:gitee"},null,-1)]))),_:1})])])}}});export{I as default};
