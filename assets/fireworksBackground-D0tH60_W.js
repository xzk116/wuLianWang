var t=Object.defineProperty,i=(i,s,e)=>((i,s,e)=>s in i?t(i,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[s]=e)(i,"symbol"!=typeof s?s+"":s,e);import{d as s,r as e,aW as h,e as o,f as a,w as r,C as l,m as n,a0 as d,U as c}from"./index-B60e1Ob1.js";import{E as p}from"./dialog-LvtrGeqH.js";import"./overlay-DYY93Q8s.js";import{E as u}from"./button-BQFE7Hxd.js";import{_ as f}from"./plugin-vueexport-helper-BCo6x5W8.js";import"./index-DnpUs-gR.js";import"./refs-CZysbovM.js";import"./index-Y9kMV7A1.js";import"./vnode-G4-cE-sq.js";import"./event-BwRzfsZt.js";import"./error-D_Dr4eZ1.js";import"./scroll-xk3SnB2i.js";import"./use-form-common-props-DzatJoKf.js";import"./isUndefined-DgmxjSXK.js";const v={id:"con"},y={class:"dialog-footer"},m=f(s({__name:"fireworksBackground",setup(t,{expose:s}){const f=e(!1),m=e(null);let g=null,x=0,w=0,j=[],b=[];const k=(t,i)=>Math.random()*(i-t)+t,M=(t,i)=>Math.floor(Math.random()*(i-t)+t),_=()=>`hsl(${M(0,360)}, 100%, 50%)`;class z{constructor(t,s,e,h,o,a,r,l){i(this,"x"),i(this,"y"),i(this,"color"),i(this,"speed"),i(this,"direction"),i(this,"vx"),i(this,"vy"),i(this,"gravity"),i(this,"friction"),i(this,"alpha"),i(this,"decay"),i(this,"size"),this.x=t,this.y=s,this.color=e,this.speed=h,this.direction=o,this.vx=Math.cos(o)*h,this.vy=Math.sin(o)*h,this.gravity=a,this.friction=r,this.alpha=1,this.decay=k(.005,.02),this.size=l}update(){this.vx*=this.friction,this.vy*=this.friction,this.vy+=this.gravity,this.x+=this.vx,this.y+=this.vy,this.alpha-=this.decay}draw(t){t.save(),t.globalAlpha=this.alpha,t.beginPath(),t.arc(this.x,this.y,this.size,0,2*Math.PI),t.fillStyle=this.color,t.fill(),t.restore()}isAlive(){return this.alpha>0}}class L{constructor(t,s,e,h,o,a){i(this,"x"),i(this,"y"),i(this,"targetY"),i(this,"color"),i(this,"speed"),i(this,"size"),i(this,"angle"),i(this,"vx"),i(this,"vy"),i(this,"trail"),i(this,"trailLength"),i(this,"exploded"),this.x=t,this.y=s,this.targetY=e,this.color=h,this.speed=o,this.size=a,this.angle=-Math.PI/2+k(-.3,.3),this.vx=Math.cos(this.angle)*this.speed,this.vy=Math.sin(this.angle)*this.speed,this.trail=[],this.trailLength=M(10,25),this.exploded=!1}update(){return this.trail.push({x:this.x,y:this.y}),this.trail.length>this.trailLength&&this.trail.shift(),this.x+=this.vx,this.y+=this.vy,this.vy+=.02,!(this.vy>=0||this.y<=this.targetY)||(this.explode(),!1)}explode(){const t=M(50,150);for(let i=0;i<t;i++){const t=k(0,2*Math.PI),i=k(2,7),s=k(1,5);b.push(new z(this.x,this.y,this.color,i,t,.05,.98,s))}}draw(t){if(t.save(),t.beginPath(),this.trail.length>1){t.moveTo(this.trail[0].x,this.trail[0].y);for(let i of this.trail)t.lineTo(i.x,i.y)}else t.moveTo(this.x,this.y),t.lineTo(this.x,this.y);t.strokeStyle=this.color,t.lineWidth=this.size,t.lineCap="round",t.stroke(),t.restore()}}function E(){const t=k(.1*x,.9*x),i=w,s=k(.1*w,.4*w),e=_(),h=k(4,8),o=k(2,5);j.push(new L(t,i,s,e,h,o));const a=k(300,800);setTimeout(E,a)}function P(){if(g){g.fillStyle="rgba(0, 0, 0, 0.3)",g.fillRect(0,0,x,w);for(let t=j.length-1;t>=0;t--){const i=j[t];i.update()?i.draw(g):j.splice(t,1)}for(let t=b.length-1;t>=0;t--){const i=b[t];i.update(),i.isAlive()?i.draw(g):b.splice(t,1)}requestAnimationFrame(P)}}h((()=>{window.removeEventListener("resize",(()=>{x=window.innerWidth,w=window.innerHeight,m.value&&(m.value.width=x,m.value.height=w)})),window.removeEventListener("click",(function(t){const i=t.clientX,s=w,e=t.clientY,h=_(),o=k(4,8),a=k(2,5);j.push(new L(i,s,e,h,o,a))}))}));const C=t=>{f.value=!1};return s({init:()=>{f.value=!0,c((()=>{if(m.value){const t=m.value;g=t.getContext("2d");let i=document.querySelector("#con");g&&i&&(x=i.offsetWidth,w=i.offsetHeight,t.width=x,t.height=w,window.addEventListener("resize",(()=>{x=i.offsetWidth,w=i.offsetHeight,t.width=x,t.height=w})),E(),P())}window.addEventListener("click",(function(t){const i=t.clientX,s=w,e=t.clientY,h=_(),o=k(4,8),a=k(2,5);j.push(new L(i,s,e,h,o,a))}))}))}}),(t,i)=>{const s=u,e=p;return a(),o(e,{modelValue:f.value,"onUpdate:modelValue":i[2]||(i[2]=t=>f.value=t),title:"弹窗",width:"700","before-close":C},{footer:r((()=>[l("div",y,[n(s,{onClick:i[0]||(i[0]=t=>f.value=!1)},{default:r((()=>i[3]||(i[3]=[d("取消")]))),_:1}),n(s,{type:"primary",onClick:i[1]||(i[1]=t=>f.value=!1)},{default:r((()=>i[4]||(i[4]=[d(" 确定 ")]))),_:1})])])),default:r((()=>[l("div",v,[l("canvas",{ref_key:"canvasRef",ref:m,class:"fireworks"},null,512)])])),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-bbf6c3d5"]]);export{m as default};
