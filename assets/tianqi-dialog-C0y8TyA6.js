import{r as e,bs as a,e as t,f as o,w as i,W as r,g as l,C as n,F as s,i as u,m as p,ap as d,a0 as m,U as c,aD as v}from"./index-D_4mb3Vt.js";import{v as w}from"./loading-D4wfu1p0.js";import{E as f}from"./dialog-Dr69udxU.js";import"./overlay-BxRxSiXw.js";import{E as g}from"./button-CWW6AGHt.js";import"./index-DpryeAo3.js";import"./use-dialog-BisRRgDQ.js";import"./event-BwRzfsZt.js";import"./use-form-common-props-B1zl3Cbv.js";import"./isUndefined-DgmxjSXK.js";import"./refs-ZES57MJJ.js";import"./index-ClDlwkbu.js";import"./vnode-Bk8efZVY.js";import"./error-D_Dr4eZ1.js";import"./scroll-Cs2n0-YO.js";const y={id:"printBox"},h={style:{"page-break-after":"always"}},j={class:"dialog-footer"},x="6102621d94ea510da0245bea6e01cb94",_={__name:"tianqi-dialog",setup(_,{expose:k}){let b=e(!1);const $=e(0),C=e(0),E=e({province:"",city:"",adcode:"",weather:"",winddirection:"",windpower:"",humidity:"",reporttime:"",humidity_float:""});let B=e(!1),U=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition((e=>{$.value=e.coords.latitude,C.value=e.coords.longitude,V($.value,C.value)}),(e=>{v.warning("获取地理位置失败:",e),b.value=!1}),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):v.warning("浏览器不支持地理位置定位")},V=async(e,a)=>{try{const t=`${a},${e}`,o=await fetch(`https://restapi.amap.com/v3/geocode/regeo?key=${x}&location=${t}`);if(!o.ok)throw new Error("网络响应错误: "+o.statusText);const i=await o.json();if("1"===i.status){const e=i.regeocode.addressComponent.adcode;e?await A(e):v.warning("无法获取城市信息")}else v.warning("无法获取地址信息")}catch(t){v.warning("获取天气信息失败",t)}},A=async e=>{try{const a=await fetch(`https://restapi.amap.com/v3/weather/weatherInfo?key=${x}&city=${e}`);if(!a.ok)throw new Error("网络响应错误: "+a.statusText);const t=await a.json();"1"===t.status?(E.value=t.lives[0],b.value=!1):(v.warning("无法获取天气信息"),b.value=!1)}catch(a){v.warning("获取天气信息失败",a),b.value=!1}};return k({init:()=>{B.value=!0,c((()=>{b.value=!0,U()}))}}),(e,c)=>{const v=g,x=f,_=w,k=a("print");return o(),t(x,{modelValue:u(B),"onUpdate:modelValue":c[2]||(c[2]=e=>d(B)?B.value=e:B=e),title:"天气状况"},{footer:i((()=>[n("div",j,[p(v,{onClick:c[0]||(c[0]=e=>d(B)?B.value=!1:B=!1)},{default:i((()=>c[4]||(c[4]=[m("关闭")]))),_:1}),r((o(),t(v,{type:"primary"},{default:i((()=>c[5]||(c[5]=[m("打印信息")]))),_:1})),[[k,"#printBox"]]),p(v,{type:"primary",onClick:c[1]||(c[1]=e=>d(B)?B.value=!1:B=!1)},{default:i((()=>c[6]||(c[6]=[m("确定")]))),_:1})])])),default:i((()=>[r((o(),l("div",y,[c[3]||(c[3]=n("p",null,"获取当前位置的天气信息",-1)),n("p",null,"省份："+s(E.value.province),1),n("p",null,"城市或地区："+s(E.value.city),1),n("p",null,"区域代码："+s(E.value.adcode),1),n("p",null,"天气状况："+s(E.value.weather),1),n("p",h,"温度："+s(E.value.temperature)+"摄氏度",1),n("p",null,"风向："+s(E.value.winddirection),1),n("p",null,"风力："+s(E.value.windpower),1),n("p",null,"湿度："+s(E.value.humidity)+"%",1),n("p",null,"更新时间："+s(E.value.reporttime),1),n("p",null,"温度："+s(E.value.temperature_float)+"摄氏度",1),n("p",null,"湿度："+s(E.value.humidity_float)+"%",1)])),[[_,u(b)]])])),_:1},8,["modelValue"])}}};export{_ as default};
