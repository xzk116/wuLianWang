var t=Object.defineProperty,i=(i,s,e)=>((i,s,e)=>s in i?t(i,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[s]=e)(i,"symbol"!=typeof s?s+"":s,e);import{d as s,r as e,aW as h,e as o,f as r,w as a,C as l,m as n,a0 as d,U as c}from"./index-C_pscggx.js";import{E as p}from"./dialog-DJrpLi5_.js";import"./overlay-9sIzXrAB.js";import{E as u}from"./button-D6WiEuQA.js";import{_ as v}from"./plugin-vueexport-helper-BCo6x5W8.js";import"./index-37GVKp2t.js";import"./use-dialog-Dtu60b6r.js";import"./event-BwRzfsZt.js";import"./use-form-common-props-k9Y9pot7.js";import"./isUndefined-DgmxjSXK.js";import"./refs-BKA3fZeB.js";import"./index-C9xgaScg.js";import"./vnode-C0RjJ-Dw.js";import"./error-D_Dr4eZ1.js";import"./scroll-BTd0uGpI.js";const f={id:"con"},y={class:"dialog-footer"},m=v(s({__name:"fireworksBackground",setup(t,{expose:s}){const v=e(!1),m=e(null);let g=null,x=0,w=0,j=[],b=[];const M=(t,i)=>Math.random()*(i-t)+t,k=(t,i)=>Math.floor(Math.random()*(i-t)+t),_=()=>`hsl(${k(0,360)}, 100%, 50%)`;class z{constructor(t,s,e,h,o,r,a,l){i(this,"x"),i(this,"y"),i(this,"color"),i(this,"speed"),i(this,"direction"),i(this,"vx"),i(this,"vy"),i(this,"gravity"),i(this,"friction"),i(this,"alpha"),i(this,"decay"),i(this,"size"),this.x=t,this.y=s,this.color=e,this.speed=h,this.direction=o,this.vx=Math.cos(o)*h,this.vy=Math.sin(o)*h,this.gravity=r,this.friction=a,this.alpha=1,this.decay=M(.005,.02),this.size=l}update(){this.vx*=this.friction,this.vy*=this.friction,this.vy+=this.gravity,this.x+=this.vx,this.y+=this.vy,this.alpha-=this.decay}draw(t){t.save(),t.globalAlpha=this.alpha,t.beginPath(),t.arc(this.x,this.y,this.size,0,2*Math.PI),t.fillStyle=this.color,t.fill(),t.restore()}isAlive(){return this.alpha>0}}class E{constructor(t,s,e,h,o,r){i(this,"x"),i(this,"y"),i(this,"targetY"),i(this,"color"),i(this,"speed"),i(this,"size"),i(this,"angle"),i(this,"vx"),i(this,"vy"),i(this,"trail"),i(this,"trailLength"),i(this,"exploded"),this.x=t,this.y=s,this.targetY=e,this.color=h,this.speed=o,this.size=r,this.angle=-Math.PI/2+M(-.3,.3),this.vx=Math.cos(this.angle)*this.speed,this.vy=Math.sin(this.angle)*this.speed,this.trail=[],this.trailLength=k(10,25),this.exploded=!1}update(){return this.trail.push({x:this.x,y:this.y}),this.trail.length>this.trailLength&&this.trail.shift(),this.x+=this.vx,this.y+=this.vy,this.vy+=.02,!(this.vy>=0||this.y<=this.targetY)||(this.explode(),!1)}explode(){const t=k(50,150);for(let i=0;i<t;i++){const t=M(0,2*Math.PI),i=M(2,7),s=M(1,5);b.push(new z(this.x,this.y,this.color,i,t,.05,.98,s))}}draw(t){if(t.save(),t.beginPath(),this.trail.length>1){t.moveTo(this.trail[0].x,this.trail[0].y);for(let i of this.trail)t.lineTo(i.x,i.y)}else t.moveTo(this.x,this.y),t.lineTo(this.x,this.y);t.strokeStyle=this.color,t.lineWidth=this.size,t.lineCap="round",t.stroke(),t.restore()}}function L(){const t=M(.1*x,.9*x),i=w,s=M(.1*w,.4*w),e=_(),h=M(4,8),o=M(2,5);j.push(new E(t,i,s,e,h,o));const r=M(300,800);setTimeout(L,r)}function P(){if(g){g.fillStyle="rgba(0, 0, 0, 0.3)",g.fillRect(0,0,x,w);for(let t=j.length-1;t>=0;t--){const i=j[t];i.update()?i.draw(g):j.splice(t,1)}for(let t=b.length-1;t>=0;t--){const i=b[t];i.update(),i.isAlive()?i.draw(g):b.splice(t,1)}requestAnimationFrame(P)}}h((()=>{window.removeEventListener("resize",(()=>{x=window.innerWidth,w=window.innerHeight,m.value&&(m.value.width=x,m.value.height=w)})),window.removeEventListener("click",(function(t){const i=t.clientX,s=w,e=t.clientY,h=_(),o=M(4,8),r=M(2,5);j.push(new E(i,s,e,h,o,r))}))}));const C=t=>{v.value=!1};return s({init:()=>{v.value=!0,c((()=>{if(m.value){const t=m.value;g=t.getContext("2d");let i=document.querySelector("#con");g&&i&&(x=i.offsetWidth,w=i.offsetHeight,t.width=x,t.height=w,window.addEventListener("resize",(()=>{x=i.offsetWidth,w=i.offsetHeight,t.width=x,t.height=w})),L(),P())}window.addEventListener("click",(function(t){const i=t.clientX,s=w,e=t.clientY,h=_(),o=M(4,8),r=M(2,5);j.push(new E(i,s,e,h,o,r))}))}))}}),(t,i)=>{const s=u,e=p;return r(),o(e,{modelValue:v.value,"onUpdate:modelValue":i[2]||(i[2]=t=>v.value=t),title:"弹窗",width:"1000","before-close":C},{footer:a((()=>[l("div",y,[n(s,{onClick:i[0]||(i[0]=t=>v.value=!1)},{default:a((()=>i[3]||(i[3]=[d("取消")]))),_:1}),n(s,{type:"primary",onClick:i[1]||(i[1]=t=>v.value=!1)},{default:a((()=>i[4]||(i[4]=[d(" 确定 ")]))),_:1})])])),default:a((()=>[l("div",f,[l("canvas",{ref_key:"canvasRef",ref:m,class:"fireworks"},null,512)])])),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-85930549"]]);export{m as default};
