import{r as e,o as a,a6 as i,g as l,f as t,m as s,w as o,C as r,h as d,a0 as n,i as c,F as u,ap as v,P as m,Q as p,e as g,aD as h}from"./index-D7ip52rg.js";import{E as j}from"./card-Bb1B2b71.js";import{E as f}from"./dialog-Dicd65VQ.js";import"./overlay-zJsoxDP-.js";import{E as _}from"./image-viewer-N2U9tK1G.js";/* empty css            */import{E as y,a as b}from"./select-DsXUxeIp.js";import"./scrollbar-BkAw2MiZ.js";import"./popper-BESiP4FJ.js";import{E as w}from"./button-B7Cpnz14.js";import{_ as x}from"./plugin-vueexport-helper-BCo6x5W8.js";import"./index-DTFD3zWA.js";import"./use-dialog-B8tOXKTe.js";import"./event-BwRzfsZt.js";import"./use-form-common-props-DwxMrRCA.js";import"./isUndefined-DgmxjSXK.js";import"./refs-Chuf_Vkk.js";import"./index-BxxfRVFK.js";import"./vnode-DhFYmvEg.js";import"./error-D_Dr4eZ1.js";import"./scroll-BAD_dPbv.js";import"./debounce-mjMVbbDV.js";import"./position-WGmtsDPf.js";import"./index-BJT6BNQs.js";import"./index-D_wDnIQN.js";import"./token-DWNpOE8r.js";import"./strings-DayrX4yN.js";import"./castArray-CEfX6IyU.js";import"./isEqual-R-_2t1hV.js";import"./Uint8Array-DqRcKjos.js";import"./arrayPush-BjozOkDH.js";import"./index-0-wkw8e5.js";import"./baseIteratee-DqyYX5Kq.js";import"./index-CDP4S9XB.js";import"./index-7fzrV7VL.js";const k={class:"app-container"},C={class:"mod-sys__log-login"},V={class:"camera_top"},E={key:0,class:"camera_btn"},I={id:"v",autoplay:"true",ref:"video",width:"600px",height:"600px",style:{"aspect-ratio":"auto 600 / 600"}},D={class:"btn_right"},U={class:"con_item"},S={class:"con_ipt"},q={class:"con_item"},z={class:"con_ipt"},A={class:"con_item"},L={class:"con_ipt"},O={class:"con_item"},P={class:"con_ipt"},T={class:"con_item"},M={class:"con_ipt"},Q={class:"paizhao"},R={class:"dialog-body"},B={class:"shot-time"},F={class:"dialog-footer"},H=x({__name:"index",setup(x){let H=e(!1),J=e({}),K=e(""),N=e("1280*960"),W=e([]),Z=e([]),$=e([]);e([]);let G=e([{value:"1280*960"},{value:"1250*1000"},{value:"1000*800"},{value:"800*600"},{value:"640*480"}]),X=e(null),Y=e([]),ee=e([]),ae=e(0),ie=e(0),le=e(0),te=e(0),se=e(""),oe=e(!1);a((()=>{le.value="",te.value="",se.value="某材料",Z.value=[],$.value=[],J.value={name:"方源",zjh:"418423245112046543"}})),i((()=>{ve()}));let re=()=>{oe.value=!0},de=()=>{Y.value=[],ee.value=[],h.success("清空成功"),oe.value=!1};const ne=()=>{ge()},ce=async()=>{try{H.value=!0,await ue(),ge()}catch(e){}},ue=async()=>{try{if(!navigator.mediaDevices)return void alert("该浏览器不支持媒体设备");let e=(await navigator.mediaDevices.enumerateDevices()).filter((e=>"videoinput"===e.kind));if(0==e.length)return h.warning("没有找到摄像头");W.value=e.map((e=>({deviceId:e.deviceId,label:e.label||`摄像头 ${W.value.length+1}`}))),K.value=W.value[0].deviceId}catch(e){}},ve=()=>{X.value&&(X.value.getTracks().forEach((e=>e.stop())),X.value=null,H.value=!1)},me=()=>{Y.value.length>=1?confirm("您确定要继续拍照吗?")?pe():h.success("提交数据"):pe()},pe=()=>{let e=document.querySelector("video");e.setAttribute("crossOrigin","anonymous");let a=document.createElement("canvas");const i=600/ae.value;a.width=e.videoWidth*i,a.height=e.videoHeight*i,a.getContext("2d").drawImage(e,0,0,a.width,a.height);let l=a.toDataURL("image/png");Y.value.push({time:(new Date).toLocaleString(),image:l.split(",")[1]}),ee.value.push(l)},ge=async()=>{let e={video:{width:N.value.split("*")[0],height:N.value.split("*")[1],deviceId:K.value}};try{X.value=await navigator.mediaDevices.getUserMedia(e),he(X.value)}catch(a){"PermissionDeniedError"===a.name&&alert("浏览器调用摄像头失败，建议使用Chrome浏览器访问")}},he=e=>{const a=document.querySelector("video");a.srcObject=e;const i=e.getVideoTracks()[0].getSettings();ae.value=i.width,ie.value=i.height,a.play()};return(e,a)=>{const i=w,h=b,x=y,Z=_,$=f,X=j;return t(),l("div",k,[s(X,{shadow:"never",class:"aui-card--fill"},{default:o((()=>[r("div",C,[r("div",V,[a[6]||(a[6]=r("p",null,"提示：只允许重新上传未审核通过或者未上传的资料。",-1)),r("div",null,[s(i,{type:"primary",onClick:ce},{default:o((()=>a[4]||(a[4]=[n("打开摄像头")]))),_:1}),s(i,{type:"warning",style:{"margin-left":"20px"},onClick:ve},{default:o((()=>a[5]||(a[5]=[n(" 关闭摄像头 ")]))),_:1})])]),c(H)?(t(),l("div",E,[r("div",null,[r("video",I,null,512)]),r("div",D,[r("div",U,[a[7]||(a[7]=r("div",{class:"con_tit"},"考生姓名：",-1)),r("div",S,u(c(J).name),1)]),r("div",q,[a[8]||(a[8]=r("div",{class:"con_tit"},"考生证件号：",-1)),r("div",z,u(c(J).zjh),1)]),r("div",A,[a[9]||(a[9]=r("div",{class:"con_tit"},"上传材料类型：",-1)),r("div",L,u(c(se)),1)]),r("div",O,[a[10]||(a[10]=r("div",{class:"con_tit"},"摄像头：",-1)),r("div",P,[s(x,{modelValue:c(K),"onUpdate:modelValue":a[0]||(a[0]=e=>v(K)?K.value=e:K=e),placeholder:"请选择摄像头",clearable:"",onChange:ne},{default:o((()=>[(t(!0),l(m,null,p(c(W),((e,a)=>(t(),g(h,{key:e.deviceId,label:e.label,value:e.deviceId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])]),r("div",T,[a[11]||(a[11]=r("div",{class:"con_tit"},"分辨率：",-1)),r("div",M,[s(x,{modelValue:c(N),"onUpdate:modelValue":a[1]||(a[1]=e=>v(N)?N.value=e:N=e),placeholder:"请选择分辨率",clearable:"",onChange:ge},{default:o((()=>[(t(!0),l(m,null,p(c(G),((e,a)=>(t(),g(h,{key:e.value,label:e.value,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])]),r("div",Q,[s(i,{type:"primary",onClick:me},{default:o((()=>a[12]||(a[12]=[n("拍照")]))),_:1}),s(i,{type:"primary",onClick:c(re)},{default:o((()=>a[13]||(a[13]=[n("查看照片")]))),_:1},8,["onClick"])])])])):d("",!0)]),s($,{modelValue:c(oe),"onUpdate:modelValue":a[3]||(a[3]=e=>v(oe)?oe.value=e:oe=e),title:"查看照片",width:"730",draggable:""},{footer:o((()=>[r("div",F,[s(i,{onClick:a[2]||(a[2]=e=>v(oe)?oe.value=!1:oe=!1)},{default:o((()=>a[14]||(a[14]=[n("关闭")]))),_:1}),s(i,{type:"primary",onClick:c(de)},{default:o((()=>a[15]||(a[15]=[n("清空照片")]))),_:1},8,["onClick"])])])),default:o((()=>[r("div",R,[(t(!0),l(m,null,p(c(Y),((e,a)=>(t(),l("div",{key:a,class:"shot-item"},[r("div",B,u(e.time),1),s(Z,{src:"data:image/png;base64,"+e.image,class:"shot-img","preview-src-list":c(ee),"initial-index":a,fit:"cover"},null,8,["src","preview-src-list","initial-index"])])))),128))])])),_:1},8,["modelValue"])])),_:1})])}}},[["__scopeId","data-v-fe7563a8"]]);export{H as default};
