import{bb as e,d as o,t,b as n,m as s,a7 as l,l as a,z as u,v as r,o as d,R as c,a6 as i,J as f,bd as m,ap as p,c as v,H as y,a2 as b,I as g,b_ as C,a1 as h,bl as x,a3 as w,B as E,bT as S,r as M,b$ as B,c0 as k,a8 as L,U as I}from"./index-XyZdYhKK.js";import{P as z}from"./vnode-DmmkSAPK.js";import{b as Y}from"./index-ArsdWgBj.js";import{U as D}from"./event-BwRzfsZt.js";import{t as O}from"./error-D_Dr4eZ1.js";import{g as j}from"./scroll-B8oQEf6B.js";import{d as A}from"./use-form-common-props-O5HSCAbS.js";import{i as F}from"./isUndefined-DgmxjSXK.js";const T=o=>{if(!o)return{onClick:e,onMousedown:e,onMouseup:e};let t=!1,n=!1;return{onClick:e=>{t&&n&&o(e),t=n=!1},onMousedown:e=>{t=e.target===e.currentTarget},onMouseup:e=>{n=e.target===e.currentTarget}}},P=t({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:u([String,Array,Object])},zIndex:{type:u([String,Number])}});const X=o({name:"ElOverlay",props:P,emits:{click:e=>e instanceof MouseEvent},setup(e,{slots:o,emit:t}){const u=n("overlay"),{onClick:r,onMousedown:d,onMouseup:c}=T(e.customMaskEvent?void 0:e=>{t("click",e)});return()=>e.mask?s("div",{class:[u.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:r,onMousedown:d,onMouseup:c},[a(o,"default")],z.STYLE|z.CLASS|z.PROPS,["onClick","onMouseup","onMousedown"]):l("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[a(o,"default")])}}),$=t({center:Boolean,alignCenter:Boolean,closeIcon:{type:r},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,headerClass:String,bodyClass:String,footerClass:String,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),N={close:()=>!0},R=(e,o,t,n)=>{const s={offsetX:0,offsetY:0},l=(o,t)=>{if(e.value){const{offsetX:l,offsetY:a}=s,u=e.value.getBoundingClientRect(),r=u.left,d=u.top,c=u.width,i=u.height,m=-r+l,p=-d+a,v=document.documentElement.clientWidth-r-c+l,y=document.documentElement.clientHeight-d-i+a;(null==n?void 0:n.value)||(o=Math.min(Math.max(o,m),v),t=Math.min(Math.max(t,p),y)),s.offsetX=o,s.offsetY=t,e.value.style.transform=`translate(${f(o)}, ${f(t)})`}},a=e=>{const o=e.clientX,t=e.clientY,{offsetX:n,offsetY:a}=s,u=e=>{const s=n+e.clientX-o,u=a+e.clientY-t;l(s,u)},r=()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",r)};document.addEventListener("mousemove",u),document.addEventListener("mouseup",r)},u=()=>{o.value&&e.value&&(o.value.removeEventListener("mousedown",a),window.removeEventListener("resize",r))},r=()=>{const{offsetX:e,offsetY:o}=s;l(e,o)};return d((()=>{c((()=>{t.value?o.value&&e.value&&(o.value.addEventListener("mousedown",a),window.addEventListener("resize",r)):u()}))})),i((()=>{u()})),{resetPosition:()=>{s.offsetX=0,s.offsetY=0,e.value&&(e.value.style.transform="")},updatePosition:r}},H=t({...$,appendToBody:Boolean,appendTo:{type:Y.to.type,default:"body"},beforeClose:{type:u(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,headerClass:String,bodyClass:String,footerClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"}}),U={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[D]:e=>m(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},V=(e,o={})=>{p(e)||O("[useLockscreen]","You need to pass a ref param to this function");const t=o.ns||n("popup"),s=v((()=>t.bm("parent","hidden")));if(!y||b(document.body,s.value))return;let l=0,a=!1,u="0";const r=()=>{setTimeout((()=>{"undefined"!=typeof document&&a&&document&&(document.body.style.width=u,w(document.body,s.value))}),200)};g(e,(e=>{if(!e)return void r();a=!b(document.body,s.value),a&&(u=document.body.style.width,h(document.body,s.value)),l=j(t.namespace.value);const o=document.documentElement.clientHeight<document.body.scrollHeight,n=x(document.body,"overflowY");l>0&&(o||"scroll"===n)&&a&&(document.body.style.width=`calc(100% - ${l}px)`)})),C((()=>r()))},q=(e,o)=>{var t;const n=E().emit,{nextZIndex:s}=S();let l="";const a=A(),u=A(),r=M(!1),c=M(!1),i=M(!1),m=M(null!=(t=e.zIndex)?t:s());let p,b;const C=B("namespace",k),h=v((()=>{const o={},t=`--${C.value}-dialog`;return e.fullscreen||(e.top&&(o[`${t}-margin-top`]=e.top),e.width&&(o[`${t}-width`]=f(e.width))),o})),x=v((()=>e.alignCenter?{display:"flex"}:{}));function w(){null==b||b(),null==p||p(),e.openDelay&&e.openDelay>0?({stop:p}=L((()=>O()),e.openDelay)):O()}function z(){null==p||p(),null==b||b(),e.closeDelay&&e.closeDelay>0?({stop:b}=L((()=>j()),e.closeDelay)):j()}function Y(){e.beforeClose?e.beforeClose((function(e){e||(c.value=!0,r.value=!1)})):z()}function O(){y&&(r.value=!0)}function j(){r.value=!1}return e.lockScroll&&V(r),g((()=>e.modelValue),(t=>{t?(c.value=!1,w(),i.value=!0,m.value=F(e.zIndex)?s():m.value++,I((()=>{n("open"),o.value&&(o.value.parentElement.scrollTop=0,o.value.parentElement.scrollLeft=0,o.value.scrollTop=0)}))):r.value&&z()})),g((()=>e.fullscreen),(e=>{o.value&&(e?(l=o.value.style.transform,o.value.style.transform=""):o.value.style.transform=l)})),d((()=>{e.modelValue&&(r.value=!0,i.value=!0,w())})),{afterEnter:function(){n("opened")},afterLeave:function(){n("closed"),n(D,!1),e.destroyOnClose&&(i.value=!1)},beforeLeave:function(){n("close")},handleClose:Y,onModalClick:function(){e.closeOnClickModal&&Y()},close:z,doClose:j,onOpenAutoFocus:function(){n("openAutoFocus")},onCloseAutoFocus:function(){n("closeAutoFocus")},onCloseRequested:function(){e.closeOnPressEscape&&Y()},onFocusoutPrevented:function(e){var o;"pointer"===(null==(o=e.detail)?void 0:o.focusReason)&&e.preventDefault()},titleId:a,bodyId:u,closed:c,style:h,overlayDialogStyle:x,rendered:i,visible:r,zIndex:m}};export{X as E,H as a,R as b,V as c,U as d,T as e,N as f,$ as g,q as u};
