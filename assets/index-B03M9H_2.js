import{aa as e,L as a,t,ba as l,z as o,_ as s,d as n,be as i,b as r,r as u,c as p,bX as d,a6 as c,o as v,e as f,f as m,w as g,C as b,i as h,k as y,n as w,m as S,V as x,$,j as B,aR as _,l as C,g as j,E as k,b7 as A,P as L,Q as M,a0 as T,F as E,a9 as F,q as G,W as I,ap as P}from"./index-D_4mb3Vt.js";import{v as U}from"./loading-D4wfu1p0.js";import{E as K}from"./card-DGDXLX3Y.js";import{E as W}from"./input-DJ1hrWmu.js";import{E as R}from"./scrollbar-BpSSelpP.js";import{u as V,E as O}from"./popper-DC4-MAEs.js";import{u as z}from"./index-CQCx7j08.js";import{C as H,I as N,U as q}from"./event-BwRzfsZt.js";import{u as D}from"./index-DPxcB5Ii.js";import{b as Z,d as X}from"./use-form-common-props-B1zl3Cbv.js";import{t as Q}from"./error-D_Dr4eZ1.js";import{d as Y}from"./debounce-juRro3Mb.js";import{_ as J}from"./plugin-vueexport-helper-BCo6x5W8.js";import"./index-DQC5d6in.js";import"./index-DpryeAo3.js";import"./isUndefined-DgmxjSXK.js";import"./arrayPush-BFgcotFS.js";const ee=t({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:o(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:o([Function,Array]),default:l},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},teleported:V.teleported,appendTo:V.appendTo,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:String,...z(["ariaLabel"])}),ae={[q]:e=>a(e),[N]:e=>a(e),[H]:e=>a(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,select:a=>e(a)},te="ElAutocomplete",le=n({name:te,inheritAttrs:!1});const oe=G(s(n({...le,props:ee,emits:ae,setup(e,{expose:a,emit:t}){const l=e,o=D(),s=i(),n=Z(),G=r("autocomplete"),I=u(),P=u(),U=u(),K=u();let V=!1,z=!1;const J=u([]),ee=u(-1),ae=u(""),le=u(!1),oe=u(!1),se=u(!1),ne=X(),ie=p((()=>s.style)),re=p((()=>(J.value.length>0||se.value)&&le.value)),ue=p((()=>!l.hideLoading&&se.value)),pe=p((()=>I.value?Array.from(I.value.$el.querySelectorAll("input")):[])),de=()=>{re.value&&(ae.value=`${I.value.$el.offsetWidth}px`)},ce=()=>{ee.value=-1},ve=async e=>{if(oe.value)return;const a=e=>{se.value=!1,oe.value||(F(e)?(J.value=e,ee.value=l.highlightFirstItem?0:-1):Q(te,"autocomplete suggestions must be an array"))};if(se.value=!0,F(l.fetchSuggestions))a(l.fetchSuggestions);else{const t=await l.fetchSuggestions(e,a);F(t)&&a(t)}},fe=Y(ve,l.debounce),me=e=>{const a=!!e;if(t(N,e),t(q,e),oe.value=!1,le.value||(le.value=a),!l.triggerOnFocus&&!e)return oe.value=!0,void(J.value=[]);fe(e)},ge=e=>{var a;n.value||("INPUT"!==(null==(a=e.target)?void 0:a.tagName)||pe.value.includes(document.activeElement))&&(le.value=!0)},be=e=>{t(H,e)},he=e=>{var a;if(z)z=!1;else{le.value=!0,t("focus",e);const o=null!=(a=l.modelValue)?a:"";l.triggerOnFocus&&!V&&fe(String(o))}},ye=e=>{setTimeout((()=>{var a;(null==(a=U.value)?void 0:a.isFocusInsideContent())?z=!0:(le.value&&$e(),t("blur",e))}))},we=()=>{le.value=!1,t(q,""),t("clear")},Se=async()=>{re.value&&ee.value>=0&&ee.value<J.value.length?Be(J.value[ee.value]):l.selectWhenUnmatched&&(t("select",{value:l.modelValue}),J.value=[],ee.value=-1)},xe=e=>{re.value&&(e.preventDefault(),e.stopPropagation(),$e())},$e=()=>{le.value=!1},Be=async e=>{t(N,e[l.valueKey]),t(q,e[l.valueKey]),t("select",e),J.value=[],ee.value=-1},_e=e=>{if(!re.value||se.value)return;if(e<0)return void(ee.value=-1);e>=J.value.length&&(e=J.value.length-1);const a=P.value.querySelector(`.${G.be("suggestion","wrap")}`),t=a.querySelectorAll(`.${G.be("suggestion","list")} li`)[e],l=a.scrollTop,{offsetTop:o,scrollHeight:s}=t;o+s>l+a.clientHeight&&(a.scrollTop+=s),o<l&&(a.scrollTop-=s),ee.value=e,I.value.ref.setAttribute("aria-activedescendant",`${ne.value}-item-${ee.value}`)},Ce=d(K,(()=>{var e;(null==(e=U.value)?void 0:e.isFocusInsideContent())||re.value&&$e()}));return c((()=>{null==Ce||Ce()})),v((()=>{I.value.ref.setAttribute("role","textbox"),I.value.ref.setAttribute("aria-autocomplete","list"),I.value.ref.setAttribute("aria-controls","id"),I.value.ref.setAttribute("aria-activedescendant",`${ne.value}-item-${ee.value}`),V=I.value.ref.hasAttribute("readonly")})),a({highlightedIndex:ee,activated:le,loading:se,inputRef:I,popperRef:U,suggestions:J,handleSelect:Be,handleKeyEnter:Se,focus:()=>{var e;null==(e=I.value)||e.focus()},blur:()=>{var e;null==(e=I.value)||e.blur()},close:$e,highlight:_e,getData:ve}),(e,a)=>(m(),f(h(O),{ref_key:"popperRef",ref:U,visible:h(re),placement:e.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[h(G).e("popper"),e.popperClass],teleported:e.teleported,"append-to":e.appendTo,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${h(G).namespace.value}-zoom-in-top`,persistent:"",role:"listbox",onBeforeShow:de,onHide:ce},{content:g((()=>[b("div",{ref_key:"regionRef",ref:P,class:w([h(G).b("suggestion"),h(G).is("loading",h(ue))]),style:y({[e.fitInputWidth?"width":"minWidth"]:ae.value,outline:"none"}),role:"region"},[S(h(R),{id:h(ne),tag:"ul","wrap-class":h(G).be("suggestion","wrap"),"view-class":h(G).be("suggestion","list"),role:"listbox"},{default:g((()=>[h(ue)?(m(),j("li",{key:0},[C(e.$slots,"loading",{},(()=>[S(h(k),{class:w(h(G).is("loading"))},{default:g((()=>[S(h(A))])),_:1},8,["class"])]))])):(m(!0),j(L,{key:1},M(J.value,((a,t)=>(m(),j("li",{id:`${h(ne)}-item-${t}`,key:t,class:w({highlighted:ee.value===t}),role:"option","aria-selected":ee.value===t,onClick:e=>Be(a)},[C(e.$slots,"default",{item:a},(()=>[T(E(a[e.valueKey]),1)]))],10,["id","aria-selected","onClick"])))),128))])),_:3},8,["id","wrap-class","view-class"])],6)])),default:g((()=>[b("div",{ref_key:"listboxRef",ref:K,class:w([h(G).b(),e.$attrs.class]),style:y(h(ie)),role:"combobox","aria-haspopup":"listbox","aria-expanded":h(re),"aria-owns":h(ne)},[S(h(W),x({ref_key:"inputRef",ref:I},h(o),{clearable:e.clearable,disabled:h(n),name:e.name,"model-value":e.modelValue,"aria-label":e.ariaLabel,onInput:me,onChange:be,onFocus:he,onBlur:ye,onClear:we,onKeydown:[$(B((e=>_e(ee.value-1)),["prevent"]),["up"]),$(B((e=>_e(ee.value+1)),["prevent"]),["down"]),$(Se,["enter"]),$($e,["tab"]),$(xe,["esc"])],onMousedown:ge}),_({_:2},[e.$slots.prepend?{name:"prepend",fn:g((()=>[C(e.$slots,"prepend")]))}:void 0,e.$slots.append?{name:"append",fn:g((()=>[C(e.$slots,"append")]))}:void 0,e.$slots.prefix?{name:"prefix",fn:g((()=>[C(e.$slots,"prefix")]))}:void 0,e.$slots.suffix?{name:"suffix",fn:g((()=>[C(e.$slots,"suffix")]))}:void 0]),1040,["clearable","disabled","name","model-value","aria-label","onKeydown"])],14,["aria-expanded","aria-owns"])])),_:3},8,["visible","placement","popper-class","teleported","append-to","transition"]))}}),[["__file","autocomplete.vue"]]));const se={class:"app-container"},ne={class:"title-box"},ie={class:"ipt-box"},re={style:{overflow:"hidden"}},ue={class:"title"},pe={style:{"font-weight":"bold"}},de={id:"map"},ce=J(n({__name:"index",setup(e){let a=u(null),t=u(!1);const l=u(0),o=u(0);let s=u(""),n=u("");v((async()=>{var e;await(e="yW1793L5DlYdszoHxKHcKf1XcFUlvZb3",new Promise((function(a,t){if(void 0!==window.BMapGL)return a(window.BMapGL),!0;window.onBMapCallback=function(){a(window.BMapGL)};let l=document.createElement("script");l.type="text/javascript",l.src=`https://api.map.baidu.com/api?v=1.0&type=webgl&ak=${e}&callback=onBMapCallback`,l.onerror=t,document.head.appendChild(l)}))),i()}));let i=()=>{t.value=!0,(new BMapGL.Geolocation).getCurrentPosition((function(e){t.value=!1,this.getStatus()==BMAP_STATUS_SUCCESS&&(l.value=e.point.lat,o.value=e.point.lng,r(l.value,o.value))}))},r=(e,l)=>{if(a.value=new BMapGL.Map("map"),a.value){const t=new BMapGL.Point(l,e);a.value.centerAndZoom(t,15),a.value.enableScrollWheelZoom(!0);const o=new BMapGL.Marker(t);a.value.addOverlay(o),p(t)}t.value=!1},p=e=>{(new BMapGL.Geocoder).getLocation(e,(function(a){n.value=a.address+";经度："+e.lng+",纬度："+e.lat}))},d=(e,t)=>{var l={onSearchComplete:function(e){var a=[];if(o.getStatus()==BMAP_STATUS_SUCCESS){for(var l=0;l<e.getCurrentNumPois();l++)a.push(e.getPoi(l));t(a)}else t(a)}},o=new BMapGL.LocalSearch(a.value,l);o.search(e)},c=e=>{let t=e.address+e.title,l=e.point;a.value.clearOverlays();const o=new BMapGL.Marker(e.point);a.value.addOverlay(o),a.value.panTo(e.point),n.value=t+";经度："+l.lng+",纬度："+l.lat};return(e,a)=>{const l=oe,o=K,i=U;return m(),j("div",se,[S(o,{shadow:"never",class:"aui-card--fill"},{default:g((()=>[b("div",ne,"地址："+E(h(n)),1),b("div",ie,[S(l,{style:{width:"100%"},"popper-class":"autoAddressClass",modelValue:h(s),"onUpdate:modelValue":a[0]||(a[0]=e=>P(s)?s.value=e:s=e),"fetch-suggestions":h(d),"trigger-on-focus":!1,placeholder:"详细地址",onSelect:h(c),clearable:"",size:"large"},{default:g((({item:e})=>[a[1]||(a[1]=b("i",{class:"el-icon-search fl mgr10"},null,-1)),b("div",re,[b("div",ue,[b("span",pe,E(e.title)+"：",1),T(E(e.address),1)])])])),_:1},8,["modelValue","fetch-suggestions","onSelect"])]),I(b("div",de,null,512),[[i,h(t)]])])),_:1})])}}}),[["__scopeId","data-v-9da152c4"]]);export{ce as default};
