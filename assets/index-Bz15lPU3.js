import{d as e,r as t,S as a,o as l,bs as o,g as s,f as r,C as i,m as d,w as n,$ as p,i as u,a0 as m,W as c,e as f,j,aD as b}from"./index-D7ip52rg.js";import{v as h}from"./loading-DxPw_3Oa.js";import{E as y}from"./dialog-Dicd65VQ.js";import"./overlay-zJsoxDP-.js";import{E as v,a as _}from"./radio-group-DWWmPQiy.js";/* empty css              */import{E as g}from"./input-DKRZ9Ufq.js";import{E as k}from"./input-number-D4JuT-Bq.js";/* empty css            */import{E as x,a as w}from"./select-DsXUxeIp.js";import"./scrollbar-BkAw2MiZ.js";import"./popper-BESiP4FJ.js";import"./tree-CzFGQOxg.js";import"./checkbox-CjWUz1I7.js";import"./text-idL1SFOL.js";import{E as V}from"./tree-select-D-U65GZr.js";import{E as C}from"./card-Bb1B2b71.js";import{a as E,E as I}from"./table-column-CvTr7kWI.js";/* empty css                */import{E as U,a as q}from"./form-item-BlA0YleD.js";import{E as F}from"./button-B7Cpnz14.js";import{D as z}from"./dept.api-B-jsYzlA.js";import{E as B}from"./message-box-Cvg2XbwU.js";import{E as D}from"./index-D_wDnIQN.js";import"./index-DTFD3zWA.js";import"./use-dialog-B8tOXKTe.js";import"./event-BwRzfsZt.js";import"./use-form-common-props-DwxMrRCA.js";import"./isUndefined-DgmxjSXK.js";import"./refs-Chuf_Vkk.js";import"./index-BxxfRVFK.js";import"./vnode-DhFYmvEg.js";import"./error-D_Dr4eZ1.js";import"./scroll-BAD_dPbv.js";import"./index-CDP4S9XB.js";import"./arrayPush-BjozOkDH.js";import"./index-BJT6BNQs.js";import"./index-0-wkw8e5.js";import"./index-Cfrhvgf0.js";import"./token-DWNpOE8r.js";import"./strings-DayrX4yN.js";import"./castArray-CEfX6IyU.js";import"./isEqual-R-_2t1hV.js";import"./Uint8Array-DqRcKjos.js";import"./debounce-mjMVbbDV.js";import"./baseIteratee-DqyYX5Kq.js";import"./index-7fzrV7VL.js";import"./index-CDOFmm9f.js";import"./initCloneObject-C46LucBl.js";import"./index-BTKOuuO-.js";const O={class:"app-container"},A={class:"search-container"},R={class:"data-table__toolbar"},S={class:"data-table__toolbar--actions"},T={class:"dialog-footer"},K=e({name:"Dept",inheritAttrs:!1,__name:"index",setup(e){const K=t(),L=t(),P=t(!1),$=t([]),J=a({}),M=a({title:"",visible:!1}),N=t(),Q=t(),W=a({status:1,parentId:"0",sort:1}),Z=a({parentId:[{required:!0,message:"上级部门不能为空",trigger:"change"}],name:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],code:[{required:!0,message:"部门编号不能为空",trigger:"blur"}],sort:[{required:!0,message:"显示排序不能为空",trigger:"blur"}]});function G(){P.value=!0,z.getList(J).then((e=>{N.value=e,P.value=!1}))}function H(){K.value.resetFields(),G()}function X(e){$.value=e.map((e=>e.id))}async function Y(e,t){const a=await z.getOptions();Q.value=[{value:"0",label:"顶级部门",children:a}],M.visible=!0,t?(M.title="修改部门",z.getFormData(t).then((e=>{Object.assign(W,e)}))):(M.title="新增部门",W.parentId=e||"0")}function ee(){L.value.validate((e=>{if(e){P.value=!0;const e=W.id;e?z.update(e,W).then((()=>{b.success("修改成功"),ae(),G()})).finally((()=>P.value=!1)):z.create(W).then((()=>{b.success("新增成功"),ae(),G()})).finally((()=>P.value=!1))}}))}function te(e){const t=[e||$.value].join(",");t?B.confirm("确认删除已选中的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{P.value=!0,z.deleteByIds(t).then((()=>{b.success("删除成功"),H()})).finally((()=>P.value=!1))}),(()=>{b.info("已取消删除")})):b.warning("请勾选删除项")}function ae(){M.visible=!1,L.value.resetFields(),L.value.clearValidate(),W.id=void 0,W.parentId="0",W.status=1,W.sort=1}return l((()=>{G()})),(e,t)=>{const a=g,l=U,b=w,z=x,B=F,le=q,oe=I,se=D,re=E,ie=C,de=V,ne=k,pe=_,ue=v,me=y,ce=o("hasPerm"),fe=h;return r(),s("div",O,[i("div",A,[d(le,{ref_key:"queryFormRef",ref:K,model:u(J),inline:!0,"label-width":"auto"},{default:n((()=>[d(l,{label:"关键字",prop:"keywords"},{default:n((()=>[d(a,{modelValue:u(J).keywords,"onUpdate:modelValue":t[0]||(t[0]=e=>u(J).keywords=e),placeholder:"部门名称",onKeyup:p(G,["enter"])},null,8,["modelValue"])])),_:1}),d(l,{label:"部门状态",prop:"status"},{default:n((()=>[d(z,{modelValue:u(J).status,"onUpdate:modelValue":t[1]||(t[1]=e=>u(J).status=e),placeholder:"全部",clearable:"",style:{width:"100px"}},{default:n((()=>[d(b,{value:1,label:"正常"}),d(b,{value:0,label:"禁用"})])),_:1},8,["modelValue"])])),_:1}),d(l,{class:"search-buttons"},{default:n((()=>[d(B,{class:"filter-item",type:"primary",icon:"search",onClick:G},{default:n((()=>t[10]||(t[10]=[m(" 搜索 ")]))),_:1}),d(B,{icon:"refresh",onClick:H},{default:n((()=>t[11]||(t[11]=[m("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),d(ie,{shadow:"hover",class:"data-table"},{default:n((()=>[i("div",R,[i("div",S,[c((r(),f(B,{type:"success",icon:"plus",onClick:t[2]||(t[2]=e=>Y())},{default:n((()=>t[12]||(t[12]=[m(" 新增 ")]))),_:1})),[[ce,["sys:dept:add"]]]),c((r(),f(B,{type:"danger",disabled:0===u($).length,icon:"delete",onClick:t[3]||(t[3]=e=>te())},{default:n((()=>t[13]||(t[13]=[m(" 删除 ")]))),_:1},8,["disabled"])),[[ce,["sys:dept:delete"]]])])]),c((r(),f(re,{data:u(N),"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},class:"data-table__content",onSelectionChange:X},{default:n((()=>[d(oe,{type:"selection",width:"55",align:"center"}),d(oe,{prop:"name",label:"部门名称","min-width":"200"}),d(oe,{prop:"code",label:"部门编号",width:"200"}),d(oe,{prop:"status",label:"状态",width:"100"},{default:n((e=>[1==e.row.status?(r(),f(se,{key:0,type:"success"},{default:n((()=>t[14]||(t[14]=[m("正常")]))),_:1})):(r(),f(se,{key:1,type:"info"},{default:n((()=>t[15]||(t[15]=[m("禁用")]))),_:1}))])),_:1}),d(oe,{prop:"sort",label:"排序",width:"100"}),d(oe,{label:"操作",fixed:"right",align:"left",width:"200"},{default:n((e=>[c((r(),f(B,{type:"primary",link:"",size:"small",icon:"plus",onClick:j((t=>Y(e.row.id,void 0)),["stop"])},{default:n((()=>t[16]||(t[16]=[m(" 新增 ")]))),_:2},1032,["onClick"])),[[ce,["sys:dept:add"]]]),c((r(),f(B,{type:"primary",link:"",size:"small",icon:"edit",onClick:j((t=>Y(e.row.parentId,e.row.id)),["stop"])},{default:n((()=>t[17]||(t[17]=[m(" 编辑 ")]))),_:2},1032,["onClick"])),[[ce,["sys:dept:edit"]]]),c((r(),f(B,{type:"danger",link:"",size:"small",icon:"delete",onClick:j((t=>te(e.row.id)),["stop"])},{default:n((()=>t[18]||(t[18]=[m(" 删除 ")]))),_:2},1032,["onClick"])),[[ce,["sys:dept:delete"]]])])),_:1})])),_:1},8,["data"])),[[fe,u(P)]])])),_:1}),d(me,{modelValue:u(M).visible,"onUpdate:modelValue":t[9]||(t[9]=e=>u(M).visible=e),title:u(M).title,width:"600px",onClosed:ae},{footer:n((()=>[i("div",T,[d(B,{type:"primary",onClick:ee},{default:n((()=>t[21]||(t[21]=[m("确 定")]))),_:1}),d(B,{onClick:ae},{default:n((()=>t[22]||(t[22]=[m("取 消")]))),_:1})])])),default:n((()=>[d(le,{ref_key:"deptFormRef",ref:L,model:u(W),rules:u(Z),"label-width":"80px"},{default:n((()=>[d(l,{label:"上级部门",prop:"parentId"},{default:n((()=>[d(de,{modelValue:u(W).parentId,"onUpdate:modelValue":t[4]||(t[4]=e=>u(W).parentId=e),placeholder:"选择上级部门",data:u(Q),filterable:"","check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])])),_:1}),d(l,{label:"部门名称",prop:"name"},{default:n((()=>[d(a,{modelValue:u(W).name,"onUpdate:modelValue":t[5]||(t[5]=e=>u(W).name=e),placeholder:"请输入部门名称"},null,8,["modelValue"])])),_:1}),d(l,{label:"部门编号",prop:"code"},{default:n((()=>[d(a,{modelValue:u(W).code,"onUpdate:modelValue":t[6]||(t[6]=e=>u(W).code=e),placeholder:"请输入部门编号"},null,8,["modelValue"])])),_:1}),d(l,{label:"显示排序",prop:"sort"},{default:n((()=>[d(ne,{modelValue:u(W).sort,"onUpdate:modelValue":t[7]||(t[7]=e=>u(W).sort=e),"controls-position":"right",style:{width:"100px"},min:0},null,8,["modelValue"])])),_:1}),d(l,{label:"部门状态"},{default:n((()=>[d(ue,{modelValue:u(W).status,"onUpdate:modelValue":t[8]||(t[8]=e=>u(W).status=e)},{default:n((()=>[d(pe,{value:1},{default:n((()=>t[19]||(t[19]=[m("正常")]))),_:1}),d(pe,{value:0},{default:n((()=>t[20]||(t[20]=[m("禁用")]))),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}});export{K as default};
