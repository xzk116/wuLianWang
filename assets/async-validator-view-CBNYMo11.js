import{s as e,c as l,dH as a,I as r,d as i,r as s,S as n,e as o,f as t,w as d,C as u,F as m,i as v,a0 as p,W as c,g,h as f,n as y,bi as h,m as j,U as x}from"./index-zthBmEkK.js";import{E as b}from"./dialog-6-GjAsZY.js";import"./overlay-OvfPWUSg.js";import{E as _}from"./button-BLdkehaO.js";import{t as k,u as w}from"./index-St2EIjAZ.js";import{S as U}from"./index-BTKOuuO-.js";import{_ as F}from"./plugin-vueexport-helper-BCo6x5W8.js";import"./index-CoC2P9bA.js";import"./use-dialog-CggR75S_.js";import"./event-BwRzfsZt.js";import"./use-form-common-props-BhFbBPIf.js";import"./isUndefined-DgmxjSXK.js";import"./refs-CMlWNiHE.js";import"./index-3UONHUgt.js";import"./vnode-DpfUKNtI.js";import"./error-D_Dr4eZ1.js";import"./scroll-CUPJOhL3.js";const V=U.default||U;function C(i,s,n={}){const{validateOption:o={},immediate:t=!0,manual:d=!1}=n,u=k(i),m=e(null),v=e(!0),p=e(!t||d),c=l((()=>{var e;return(null==(e=m.value)?void 0:e.errors)||[]})),g=l((()=>{var e;return(null==(e=m.value)?void 0:e.fields)||{}})),f=l((()=>new V(a(s)))),y=async()=>{v.value=!1,p.value=!1;try{await f.value.validate(u.value,o),p.value=!0,m.value=null}catch(e){m.value=e}finally{v.value=!0}return{pass:p.value,errorInfo:m.value,errors:c.value,errorFields:g.value}};d||r([u,f],(()=>y()),{immediate:t,deep:!0});const h={isFinished:v,pass:p,errors:c,errorInfo:m,errorFields:g,execute:y};return{...h,then:(e,l)=>new Promise(((e,l)=>{w(v).toBe(!0).then((()=>e(h))).catch((e=>l(e)))})).then(e,l)}}const E={flex:"~ col gap-2"},I={key:0,"text-red":""},q={key:0,"text-red":""},N={key:0,"text-red":""},O={key:0},S={class:"dialog-footer"},A=F(i({__name:"async-validator-view",setup(e,{expose:l}){const a=s(!1),r=n({email:"",name:"",age:""}),i=s(!1),{pass:k,isFinished:w,errorFields:U}=C(r,{name:{type:"string",min:5,max:20,required:!0,message:"名称必须为5-20个字符"},age:{type:"number",required:!0,message:"年龄必须为数字"},email:[{type:"email",required:!0,message:"请输入有效的邮箱地址"}]}),F=e=>{a.value=!1};return l({init:()=>{a.value=!0,x((()=>{r.email="",r.name="",r.age="",i.value=!1}))}}),(e,l)=>{const s=_,n=b;return t(),o(n,{modelValue:a.value,"onUpdate:modelValue":l[6]||(l[6]=e=>a.value=e),title:"async-validator案例",width:"500","before-close":F},{footer:d((()=>[u("div",S,[j(s,{onClick:l[4]||(l[4]=e=>a.value=!1)},{default:d((()=>l[11]||(l[11]=[p("取消")]))),_:1}),j(s,{type:"primary",onClick:l[5]||(l[5]=e=>a.value=!1)},{default:d((()=>l[12]||(l[12]=[p(" 确定 ")]))),_:1})])])),default:d((()=>{var e,a,n,o,x,b,_,F,V,C,S,A;return[u("div",null," 校验是否全部通过:"+m(v(k)),1),u("div",null," 校验是否结束:"+m(v(w)),1),l[13]||(l[13]=u("hr",null,null,-1)),u("div",E,[u("div",null,[l[7]||(l[7]=p(" 邮箱 ")),c(u("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>r.email=e),class:y({"!border-red":null==(a=null==(e=v(U))?void 0:e.email)?void 0:a.length}),type:"text",placeholder:"Email"},null,2),[[h,r.email]]),(null==(o=null==(n=v(U))?void 0:n.email)?void 0:o.length)?(t(),g("div",I,m(v(U).email[0].message),1)):f("",!0)]),u("div",null,[l[8]||(l[8]=p(" 名称 ")),c(u("input",{"onUpdate:modelValue":l[1]||(l[1]=e=>r.name=e),class:y({"!border-red":null==(b=null==(x=v(U))?void 0:x.name)?void 0:b.length}),type:"text",placeholder:"Name"},null,2),[[h,r.name]]),(null==(F=null==(_=v(U))?void 0:_.name)?void 0:F.length)?(t(),g("div",q,m(v(U).name[0].message),1)):f("",!0)]),u("div",null,[l[9]||(l[9]=p(" 年龄 ")),c(u("input",{"onUpdate:modelValue":l[2]||(l[2]=e=>r.age=e),class:y({"!border-red":null==(C=null==(V=v(U))?void 0:V.age)?void 0:C.length}),type:"number",placeholder:"Age"},null,2),[[h,r.age,void 0,{number:!0}]]),(null==(A=null==(S=v(U))?void 0:S.age)?void 0:A.length)?(t(),g("div",N,m(v(U).age[0].message),1)):f("",!0)]),u("div",null,[i.value?(t(),g("div",O,m(JSON.stringify(r)),1)):f("",!0),j(s,{type:"primary",disabled:!v(k),onClick:l[3]||(l[3]=e=>i.value=!0)},{default:d((()=>l[10]||(l[10]=[p("提交")]))),_:1},8,["disabled"])])])]})),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-cd4bc713"]]);export{A as default};
