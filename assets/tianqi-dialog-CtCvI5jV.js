import{r as e,bs as a,e as t,f as o,w as i,W as r,g as l,C as n,F as s,i as u,m as p,ap as d,a0 as c,U as m,aD as v}from"./index-DGroVdsV.js";import{v as w}from"./loading-CBsDfktF.js";import{E as f}from"./dialog-ffa3i-va.js";import"./overlay-DNLo_tzA.js";import{E as g}from"./button-jPUt73ej.js";import"./index-Pu12wYp-.js";import"./refs-CB1av2oj.js";import"./index-BXBdPzi5.js";import"./vnode-In80UGuP.js";import"./event-BwRzfsZt.js";import"./error-D_Dr4eZ1.js";import"./scroll-B97Rr3Br.js";import"./use-form-common-props-CVlDfman.js";import"./isUndefined-DgmxjSXK.js";const y={id:"printBox"},h={style:{"page-break-after":"always"}},j={class:"dialog-footer"},x="6102621d94ea510da0245bea6e01cb94",_={__name:"tianqi-dialog",setup(_,{expose:k}){let b=e(!1);const $=e(0),C=e(0),E=e({province:"",city:"",adcode:"",weather:"",winddirection:"",windpower:"",humidity:"",reporttime:"",humidity_float:""});let A=e(!1),U=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition((e=>{$.value=e.coords.latitude,C.value=e.coords.longitude,V($.value,C.value)}),(e=>{v.warning("获取地理位置失败:",e),b.value=!1}),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):v.warning("浏览器不支持地理位置定位")},V=async(e,a)=>{try{const t=`${a},${e}`,o=await fetch(`https://restapi.amap.com/v3/geocode/regeo?key=${x}&location=${t}`);if(!o.ok)throw new Error("网络响应错误: "+o.statusText);const i=await o.json();if("1"===i.status){const e=i.regeocode.addressComponent.adcode;e?await q(e):v.warning("无法获取城市信息")}else v.warning("无法获取地址信息")}catch(t){v.warning("获取天气信息失败",t)}},q=async e=>{try{const a=await fetch(`https://restapi.amap.com/v3/weather/weatherInfo?key=${x}&city=${e}`);if(!a.ok)throw new Error("网络响应错误: "+a.statusText);const t=await a.json();"1"===t.status?(E.value=t.lives[0],b.value=!1):(v.warning("无法获取天气信息"),b.value=!1)}catch(a){v.warning("获取天气信息失败",a),b.value=!1}};return k({init:()=>{A.value=!0,m((()=>{b.value=!0,U()}))}}),(e,m)=>{const v=g,x=f,_=w,k=a("print");return o(),t(x,{modelValue:u(A),"onUpdate:modelValue":m[2]||(m[2]=e=>d(A)?A.value=e:A=e),title:"天气状况"},{footer:i((()=>[n("div",j,[p(v,{onClick:m[0]||(m[0]=e=>d(A)?A.value=!1:A=!1)},{default:i((()=>m[4]||(m[4]=[c("关闭")]))),_:1}),r((o(),t(v,{type:"primary"},{default:i((()=>m[5]||(m[5]=[c("打印信息")]))),_:1})),[[k,"#printBox"]]),p(v,{type:"primary",onClick:m[1]||(m[1]=e=>d(A)?A.value=!1:A=!1)},{default:i((()=>m[6]||(m[6]=[c("确定")]))),_:1})])])),default:i((()=>[r((o(),l("div",y,[m[3]||(m[3]=n("p",null,"获取当前位置的天气信息",-1)),n("p",null,"省份："+s(E.value.province),1),n("p",null,"城市或地区："+s(E.value.city),1),n("p",null,"区域代码："+s(E.value.adcode),1),n("p",null,"天气状况："+s(E.value.weather),1),n("p",h,"温度："+s(E.value.temperature)+"摄氏度",1),n("p",null,"风向："+s(E.value.winddirection),1),n("p",null,"风力："+s(E.value.windpower),1),n("p",null,"湿度："+s(E.value.humidity)+"%",1),n("p",null,"更新时间："+s(E.value.reporttime),1),n("p",null,"温度："+s(E.value.temperature_float)+"摄氏度",1),n("p",null,"湿度："+s(E.value.humidity_float)+"%",1)])),[[_,u(b)]])])),_:1},8,["modelValue"])}}};export{_ as default};
